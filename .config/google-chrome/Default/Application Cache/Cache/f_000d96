function SEc(a,b,c){b=rb(a,b.equals,b);0<=b&&b!=c&&(b=yb(a,b,1),yb(a,c,0,b[0]))}function TEc(a){var b=ritz.convertPivotTableDefToRitz(zAa.Wb(FAa(a))),b=zAa.ld((new ej).U(),b);if(null!=a.C){var c;c=Pf(b,6);c=Pf(c,1);J(c,6,""+a.C)}return b}function UEc(a,b,c){function d(a){if(a.Rr()){var b=Math.min(e,c),d=Math.max(e,c);a=a.Jr();var m=a.Er();m==e?a.Kn(c):m>=b&&m<=d&&(e>c?a.Kn(m+1):e<c&&a.Kn(m-1))}}var e=jb(a.q,b);SEc(a.q,b,c);D(a.o,d);D(a.k,d)}
function VEc(a,b){var c=rb(a.q,b.equals,b);if(0<=c){Bb(a.q,c);var d=function(a){if(a.Rr()){var b=a.Jr(),d=b.Er();d==c?a.kC():d>c&&b.Kn(d-1)}};D(a.o,d);D(a.k,d)}}function WEc(a,b,c){null!=c?(xb(a.q,b,c),b=function(a){if(a.Rr()){a=a.Jr();var b=a.Er();b>=c&&a.Kn(b+1)}},D(a.o,b),D(a.k,b)):a.q.push(b)}
function XEc(a,b){var c=new Sf;J(c,3,a);var d=b.Zc,e=b.isRow(),f=new Tf;if(!e){var h=new Uf,l=b.Tb();J(h,1,l);J(f,2,h)}d||(h=new Uf,l=b.Kb(),J(h,1,l),f.KE(h));J(c,2,f);f=new Tf;e||(e=new Uf,h=b.lb()+1,J(e,1,h),J(f,2,e));d||(d=new Uf,e=b.ob()+1,J(d,1,e),f.KE(d));J(c,1,f);return c}function YEc(a,b){J(a,2,b)}function ZEc(a,b){J(a,3,b)}function $Ec(a,b){J(a,8,b)}function aFc(a){return Pf(a,8)}function bFc(a,b){J(a,3,b)}
function cFc(a,b,c){var d=b.ob();b=b.lb();a=a?a.ad(d,b+c).getDisplayValue():"";""==a&&(a="Column "+Us(b+c));return a};function B$(a,b){xF.call(this,1602,b);this.j=a}B(B$,xF);B$.prototype.Hc=function(){return B$.H.Hc.call(this)};B$.prototype.kd=q(47);B$.prototype.dd=function(){var a=new Yr,b=TEc(this.j);J(a,1,b);return a};function C$(a,b){N.call(this,a,b)}B(C$,N);function dFc(a){a=""+bu(jW(Yt(a,{title:Zt("Report Editor"),Ze:$t('<div id="waffle-pivot-pane"><div id="waffle-pivot-range-selection"><div class="input-selection-button goog-inline-block"></div><span class="waffle-pivot-label-text waffle-pivot-range-span" id="waffle-pivot-range-text"></span><span class="waffle-pivot-label-text waffle-pivot-range-span">&nbsp;-&nbsp;</span>'+bu(gz({Cd:"goog-inline-block waffle-pivot-label-button",content:$t("Edit range..."),id:"waffle-pivot-range-selection-button",style:4}))+
'</div><div class="waffle-pivot-container"><div class="waffle-pivot-label">'+eFc({dn:Zt("Rows"),id:"waffle-pivot-add-field-row"})+'</div><div id="waffle-pivot-row-label" class="waffle-pivot-drop-target"></div></div><div class="waffle-pivot-container"><div class="waffle-pivot-label">'+eFc({dn:Zt("Columns"),id:"waffle-pivot-add-field-column"})+'</div><div id="waffle-pivot-column-label" class="waffle-pivot-drop-target"></div></div><div class="waffle-pivot-container"><div class="waffle-pivot-label">'+
eFc({dn:Zt("Values"),id:"waffle-pivot-add-field-value"})+'<div id="waffle-pivot-aggr"><span id="waffle-pivot-aggr-label" class="waffle-pivot-label-text">as:&nbsp;</span><div id="waffle-pivot-aggr-select"></div></div></div><div id="waffle-pivot-values" class="waffle-pivot-drop-target"></div></div><div class="waffle-pivot-container"><div class="waffle-pivot-label">'+eFc({dn:Zt("Filter"),id:"waffle-pivot-add-field-filter"})+'</div><div id="waffle-pivot-filter" class="waffle-pivot-drop-target"></div></div><div id="waffle-pivot-button-container"><label><input type="radio" name="autoupdate" value="autoupdate" checked id="waffle-pivot-update-auto" />Update table on each change</label><br /><label><input type="radio" name="autoupdate" value="manual" id="waffle-pivot-update-manual"/>Manually</label><button id="waffle-pivot-button-update" disabled="true">Update table</button><br /></div></div>')})));
return Ut(a)}function eFc(a){var b;b=""+('<strong id="'+Y(a.id)+'-field-label">'+W(a.dn)+'</strong><span class="waffle-pivot-label-text">&nbsp;-&nbsp;</span>');var c;c=Zt("Add field");b+=bu(gz({Cd:"goog-inline-block waffle-pivot-label-button",content:c,attributes:au('aria-label="'+Y(a.dn)+" "+Y(c)+'"'),id:a.id,style:4}));return Ut(b)}
function fFc(a){return Ut('<div class="waffle-pivot-pill" role="group" tabindex="0"><table class="waffle-pivot-pill-main-table" role="presentation"><tbody><tr><td class="waffle-pivot-pill-main-table-text"><strong>'+W(a.MU)+'&nbsp;</strong><span class="waffle-pivot-pill-title"></span></td><td class="waffle-pivot-pill-main-table-fill"><div class="waffle-pivot-pill-draghandle"></div></td><td class="waffle-pivot-pill-close waffle-pivot-pill-nodrag"></td></tr></tbody></table></div>')};function D$(a,b,c,d,e){Im.call(this,e);this.G=a;this.K=c;this.J=d;this.pe(b)}B(D$,Im);t=D$.prototype;t.Ra=function(){this.aa=Pt(fFc,{MU:this.G})};t.Da=function(){D$.H.Da.call(this);var a=this.Q(),b=S(this);this.B=yh(a,"span","waffle-pivot-pill-title",this.getElement())[0];var c=new iz("\u2715",a,4);c.render(yh(a,"td","waffle-pivot-pill-close",this.getElement())[0]);lm(c.getElement(),"Close edit field and remove from pivot table");L(this,c);b.F(c,"action",this.qib)};
t.dF=function(){var a=new C$("pivot-pill-changed",this);a.j=this;this.dispatchEvent(a)};function gFc(a,b){a.Q().Of(a.B,b);lm(a.getElement(),"Edit field: "+(a.G+(" "+(b+"."))));a.B.title=b}function hFc(a){return a.Q().hI(a.B)}function E$(a,b){return cFc(a.K,a.J,b)}function iFc(a,b,c){a=a.Q();return a.X("span",c,a.createTextNode(b+"\u00a0"))}function F$(a){return a.Q().X("div","waffle-pivot-pill-nodrag")}
t.DR=function(a){var b=this.Q(),c=b.X("div","waffle-pivot-pill-section",arguments);1<fh(this.getElement()).length&&om(c,"waffle-pivot-pill-section-top-border");b.appendChild(this.getElement(),c)};t.xx=function(a){S(this).F(a.getElement(),"mouseover",this.Q_).F(a.getElement(),"mouseout",this.Q_)};t.Q_=function(a){fna(a.target,"waffle-pivot-select-hover")};t.xm=g("J");t.Hb=g("K");t.qib=function(){var a=new C$("pivot-remove-pill",this);a.j=this;this.dispatchEvent(a)};function G$(){}B(G$,UD);ia(G$);G$.prototype.Mb=q("waffle-pivot-select");G$.prototype.tC=function(a){return a.X("div","goog-inline-block "+(this.Mb()+"-dropdown"),"\u00a0\u25be")};function H$(a,b,c,d){D$.call(this,"Filter:",a,b,c,d);this.j=new eG("",null,G$.getInstance(),d);L(this,this.j)}B(H$,D$);H$.prototype.Da=function(){H$.H.Da.call(this);var a=this.getModel();gFc(this,E$(this,a.dg()));var a=iFc(this,"Show:"),b=F$(this);this.j.Ta(b);this.j.Ur=!0;this.j.qw("Loading...");lm(this.j.aa,"Show:");var c=new jFc;L(this,c);this.j.Pe(c);this.xx(this.j);this.DR(a,b)};function I$(a){return a.j.Eb().j}
H$.prototype.xx=function(a){H$.H.xx.call(this,a);S(this).F(I$(this),"filters_selected",this.k).F(I$(this),"filtering_cancelled",this.o)};function kFc(a,b,c){var d=[];if(!c)return d;a=b.lb()+a;var e=yf(b,"r");for(b=b.ob()+1;b<e.end;b++){var f=c.ad(b,a);Ob(d,f.getDisplayValue(),hMb)}return d}function lFc(a){var b=I$(a),c=a.getModel().o(),d=new ed(c),e=nb(d8(b),function(a,b){return d.contains(b)?a-1:a},d8(b).length);eMb(b,c);mFc(a,e)}
function mFc(a,b){var c=I$(a);0==b?a.j.qw(Htc()):(c=d8(c).length-b,a.j.qw(Htc(c)))}H$.prototype.k=function(a){this.j.nd(!1);mFc(this,a.V.length);this.dF()};H$.prototype.o=function(){this.j.nd(!1);var a=this.j.aa;try{od&&this.Q().kb().body.focus(),a.focus()}catch(b){}lFc(this)};function jFc(a){RD.call(this,a);this.j=new tW([],a)}B(jFc,RD);jFc.prototype.Da=function(){jFc.H.Da.call(this);this.j.render(this.pb());var a=new Fy(this.j.aa,this.Q());Gy(a);L(this,a)};function J$(a,b,c,d,e){D$.call(this,"Group by:",a,b,c,e);this.M=d}B(J$,D$);t=J$.prototype;
t.Da=function(){J$.H.Da.call(this);var a=this.getModel();gFc(this,E$(this,a.dg()));var b=this.Q(),a=iFc(this,"Order:"),c=F$(this),d=new RD;d.Ia(new MD(b.Hg("Ascending"),1),!0);d.Ia(new MD(b.Hg("Descending"),2),!0);b=this.C=new eG("",d,G$.getInstance(),b);b.Ta(c);b.Oa(aFc(this.getModel()));lm(b.getElement(),"Order:");this.xx(b);this.DR(a,c);var b=this.Q(),c=iFc(this,"Sort by:"),a=F$(this),d=new RD,e=E$(this,this.getModel().dg());d.Ia(new MD(e,-1),!0);d=this.o=new eG("",d,G$.getInstance(),b);d.Ta(a);
lm(d.getElement(),"Sort by:");S(this).F(d.getElement(),"mouseover",this.Q_).F(d.getElement(),"mouseout",this.Q_).F(d,"action",this.uib);b=A(b.X,b,"div",["goog-inline-block","waffle-pivot-pill-sort-by"]);c=b(c);this.D=b(a);this.DR(c,this.D);a=this.getModel();a=Pf(a,3);c=iFc(this,"Show totals","waffle-pivot-pill-align-middle waffle-pivot-pill-nodrag");b=F$(this);om(b,"goog-inline-block");this.k=new tJ;rJ(this.k,c);this.k.gc(a);this.k.render(b);S(this).F(this.k,"change",this.dF);this.DR(b,c)};
t.isRow=g("M");t.uib=function(a){a=new C$("pivot-sort-by-change",a.currentTarget);a.j=this;this.dispatchEvent(a)};t.vib=function(a){a=new C$("pivot-sort-key-change",a.currentTarget);a.j=this;this.dispatchEvent(a)};function nFc(a){var b=[];if(a.j)for(var c=a.j.Sb(),d=0;d<c;d++)0<=a.j.dc(d).Z()&&b.push(a.j.dc(d).sg());return b}function oFc(a){if(!a.j){var b=a.Q(),c=F$(a);om(c,"waffle-pivot-multi-select");a.j=new DD("horizontal",null,b);a.j.Ta(c);b.appendChild(a.D,c)}}
t.xx=function(a){J$.H.xx.call(this,a);S(this).F(a,"hide",this.dF)};t.L=function(){J$.H.L.call(this);M(this.C);M(this.o);M(this.j);M(this.k);this.D=null};function K$(a,b,c,d){D$.call(this,"Display:",a,b,c,d)}B(K$,D$);var pFc="SUM COUNTA COUNT COUNTUNIQUE AVERAGE MAX MIN MEDIAN PRODUCT STDEV STDEVP VAR VARP".split(" ");K$.prototype.Da=function(){K$.H.Da.call(this);var a=this.getModel();gFc(this,E$(this,a.dg()));qFc(this)};
function qFc(a){var b=a.Q(),c=iFc(a,"Summarize by:"),d=F$(a),e=new RD;D(pFc,function(a){e.Ia(new MD(a),!0)});b=a.j=new eG("",e,G$.getInstance(),b);b.Ta(d);b.Oa(a.getModel().Lt());lm(b.getElement(),"Summarize by:");a.xx(b);a.DR(c,d)}K$.prototype.Z=function(){return this.j.Z()};K$.prototype.xx=function(a){K$.H.xx.call(this,a);S(this).F(a,"hide",this.dF)};K$.prototype.L=function(){K$.H.L.call(this);M(this.j)};function L$(a,b,c,d,e){kW.call(this,e);this.Ua=b;this.fb=c;this.ba=d;this.k={};this.B=!0;this.V=new rFc;this.M=new R(this);this.P=new WW;this.K=[];this.C=this.o=null;this.Va=new MD("No fields left to add",void 0,e);this.Va.ga(!1)}B(L$,kW);
var M$={mv:"waffle-pivot-values",Os:"waffle-pivot-filter",X0:"waffle-pivot-column-label",B2:"waffle-pivot-row-label",H0:"waffle-pivot-add-field-value",F0:"waffle-pivot-add-field-filter",G0:"waffle-pivot-add-field-row",E0:"waffle-pivot-add-field-column",I0:"waffle-pivot-aggr-select",J0:"waffle-pivot-aggr",xDa:"waffle-pivot-apply",U0:"waffle-pivot-button-container",iHa:"waffle-pivot-range-selection",jHa:"waffle-pivot-range-selection-button",kHa:"waffle-pivot-range-text",SL:"waffle-pivot-button-update",
X2:"waffle-pivot-update-auto",Y2:"waffle-pivot-update-manual"},N$={ML:"row-breakout",eL:"col-breakout",Os:"filter",mv:"aggregation"};t=L$.prototype;t.LR=null;t.Ra=function(){var a=this.Q();this.aa=Pt(dFc,{id:this.getId()});var b=new RD(a);b.Ia(new MD("Columns",2,a),!0);b.Ia(new MD("Rows",1,a),!0);this.D=new eG("",b,G$.getInstance(),a)};
t.Da=function(){function a(a,b){e.F(Og(a),"click",b)}L$.H.Da.call(this);var b=this.Q();Q(b.getElement(M$.U0),!1);this.G=jc(N$.mv,b.getElement(M$.mv),N$.Os,b.getElement(M$.Os),N$.ML,b.getElement(M$.B2),N$.eL,b.getElement(M$.X0));this.Na=jc(M$.H0,N$.mv,M$.F0,N$.Os,M$.G0,N$.ML,M$.E0,N$.eL);this.jb=b.getElement(M$.SL);var c=Ky(gN,""),d=Dtc(),e=S(this),f;for(f in this.Na){var h=new VD("",new RD(b,d),c,b);L(this,h);h.Ta(b.getElement(f));e.F(h,"show",this.ylb).F(h.Eb(),"action",this.xlb)}a(M$.SL,this.Ilb);
a(M$.X2,this.zBa);a(M$.Y2,this.zBa);this.J=b.getElement(M$.J0);Q(this.J,!1);this.D.Ta(b.getElement(M$.I0));e.F(this.D,"action",this.zlb);this.C||(this.C=new Fm(this.pb()));e.F(this.C,"focusin",this.Dlb).F(this.C,"focusout",this.Elb);sFc(this)};t.Dlb=function(a){this.o=tFc(this,a.target)};t.Elb=function(a){if(a=a.relatedTarget){var b=this.pb();vh(a,function(a){return a==b})||(this.o=null)}};
function tFc(a,b){if(!b)return null;var c=a.Q().Lna(b,"waffle-pivot-pill");if(!c)return null;var d=null,e=null;Ub(a.k,function(a,b){return(d=qb(a,function(a){return a.getElement()==c}))?(e=b,!0):!1});return d?{container:e,label:hFc(d)}:null}
function uFc(a){var b=a.Q();if(a.o){var c=a.o.container,d=a.k[c];if(d&&a.o.label)for(var e=0,f;f=d[e];e++)if(hFc(f)==a.o.label){vFc(a,f.getElement());return}d&&0<d.length?vFc(a,d[d.length-1].getElement()):(d=Zb(a.Na,function(a){return a==c}),vFc(a,b.getElement(d)))}}
t.pe=function(a){L$.H.pe.call(this,a);wFc(this,function(){function b(a,b){var c="row-breakout"==a,c=new J$(b,O$(this),P$(this),c,this.Q());c.render();xFc(this,c,a)}this.reset();D(a.Kt(),function(a){a=new H$(a,O$(this),P$(this),this.Q());a.render();xFc(this,a,"filter")},this);D(a.fo(),za(b,"row-breakout"),this);D(a.co(),za(b,"col-breakout"),this);D(a.fq(),function(a){a=new K$(a,O$(this),P$(this),this.Q());a.render();xFc(this,a,"aggregation")},this);var c;c=(c=(c=Iu(this.ba.j,a.nn()))?c.k:null)?bt(a.xm(O$(this)),
c):"#REF!";yFc(this,c);this.V.Oa(c);(c=this.k.aggregation)&&2<=c.length?(Q(this.J,!0),this.D.Oa(a.Xo())):Q(this.J,!1);uFc(this)});zFc(this,function(){var a=this.k.filter;a&&D(a,function(a){var b=I$(a),e;e=kFc(a.getModel().dg(),a.xm(),a.Hb());dMb(b,e);lFc(a)},this)})};t.focus=function(){L$.H.focus.call(this);vFc(this,Rg("waffle-sidebar-title",this.getElement()))};function xFc(a,b,c){a.G[c].appendChild(b.getElement());a.k[c]||(a.k[c]=[]);a.k[c].push(b);b.hc(a);AFc(a,b);sFc(a)}
function AFc(a,b){S(a).F(b,"pivot-remove-pill",a.Hlb).F(b,"pivot-pill-changed",a.Glb).F(b.getElement(),"keydown",a.Flb);var c=new C$("pivot-pill-created");c.j=b;a.dispatchEvent(c)}function sFc(a){a.M.Fb();M(a.P);var b=a.P=new WW;Rb(a.G,function(a){jNb(b,a)});b.Id();a.M.F(b,"beforedragstart",a.Alb).F(b,"dragstart",a.Clb).F(b,"dragend",a.Blb)}t.reset=function(){Rb(this.k,function(a){D(a,M)});this.k={}};function yFc(a,b){var c=a.Q();c.Of(c.getElement("waffle-pivot-range-text"),b)}
t.Hlb=function(a){var b=new C$("pivot-pill-removed",this);b.j=a.target;b.container=Zb(this.k,function(b){return sb(b,a.target)});b.container&&(Ab(this.k[b.container],a.target),this.o={container:b.container,label:null},this.dispatchEvent(b))};t.Glb=function(a){a.container=Zb(this.k,function(b){return sb(b,a.target)})};t.Flb=function(a){!a.shiftKey||38!=a.keyCode&&40!=a.keyCode||BFc(this,a.target,38==a.keyCode)};
function BFc(a,b,c){var d=null,e=-1;Ub(a.G,function(a,c){e=jb(a.childNodes,b);return 0<=e?(d=c,!0):!1});var f=a.k[d];if(!(!f||1>=f.length||(c=c?e-1:e+1,0>c||c>f.length-1))){Jtc(f,e,c);var h=new C$("pivot-pill-changed",a);h.j=f[c];h.container=d;h.q=d;h.position=c;a.dispatchEvent(h)}}t.Ilb=function(){this.dispatchEvent("pivot-table-update")};t.zBa=function(a){a=this.B="autoupdate"==a.target.value;(this.jb.disabled=a)&&this.dispatchEvent("pivot-table-update")};t.zlb=function(){this.dispatchEvent("pivot-aggregation-orientation-changed")};
t.Xo=function(){return this.D.Z()};function CFc(a,b,c,d){var e=a.V;Cg(a.LR);VLb(a.Ua,e,e.Z(),!1,!1,!0,A(a.Jlb,a,b,c,!!d))}t.Jlb=function(a,b,c,d){var e=this.V,f=this.ba;e.j=!1;var h=e.Z();this.LR=Ag(d,"afterhide",function(){if(e.j){var d=Zs(e.Z(),f.j,!0,!0);d?a(d):(e.Oa(h),b())}else b();c||vFc(this,Og("waffle-pivot-range-selection-button"))},!1,this)};
t.ylb=function(a){var b=a.target.getParent(),c=b.Eb();this.Xa=this.Na[b.aa.id];wFc(this,function(){var a=this.Xa,e=O$(this),f=P$(this),a=DFc(this,a);c.sd(!0);for(var h=yf(f,"c"),l=0,m=h.start;m<h.end;m++){var n=cFc(e,f,l);n&&!a[n]&&c.Ia(new MD(n,l),!0);l++}0==c.Sb()&&c.Ia(this.Va,!0);LT(b,!0);b.vu();LT(b,!1)})};function vFc(a,b){try{od&&a.Q().kb().body.focus(),b.focus(),a.fb.j(2)}catch(c){}}
t.xlb=function(a){var b=this.Xa;a=a.target.Z();var c=new C$("pivot-pill-added",this);c.container=b;c.C=a;this.o={container:b,label:null};this.dispatchEvent(c)};t.Alb=function(a){for(var b=a.event.target||a.event.j.target;b instanceof Element&&!nm(b,"waffle-pivot-pill");b=b.parentNode)if(nm(b,"waffle-pivot-pill-nodrag")){a.preventDefault();break}};t.Clb=function(a){var b=hl(a.j).width;Yk(a.q,b)};
t.Blb=function(a){var b,c,d,e,f=new C$("pivot-pill-changed",this);Ub(this.G,function(c,d){e=jb(c.childNodes,a.j);return 0<=e?(b=d,!0):!1});Ub(this.k,function(b,e){var m=qb(b,function(b){return b.getElement()==a.j});return m?(c=e,f.j=d=m,!0):!1});this.k[b]||(this.k[b]=[]);Ab(this.k[c],d);xb(this.k[b],d,e);f.container=b;f.q=c;f.position=e;this.dispatchEvent(f)};
function DFc(a,b){function c(a){a=f(a.dg());e[a]=!0}var d=a.getModel(),e={},f=A(cFc,a,O$(a),P$(a));if(d)switch(b){case "filter":D(d.Kt(),c);break;case "row-breakout":case "col-breakout":D(d.fo(),c),D(d.co(),c)}return e}function wFc(a,b){var c=EFc(a);if(c){var d=P$(a),d=new lf(d.ob(),d.lb(),d.ob()+1,d.Tb());Ie?FFc(a,d,b):kq(c.Mf,d,A(b,a),S(a))}else b.call(a)}function zFc(a,b){var c=EFc(a);c?Ie?FFc(a,P$(a),b):kq(c.Mf,P$(a),A(b,a),S(a)):b.call(a)}
function FFc(a,b,c){b=iq(Eu(EFc(a)),b).addCallback(c,a);a.K.push(b);bm(b,za(Ab,a.K,b))}function EFc(a){var b=a.getModel();return Iu(a.ba.j,b.nn())}function O$(a){return(a=EFc(a))?a.Hb():null}function P$(a){return a.getModel().xm(O$(a))}t.L=function(){L$.H.L.call(this);Rb(this.k,function(a){D(a,M)});this.k={};Cg(this.LR);this.LR=null;M(this.P);M(this.M);D(this.K,ww)};function rFc(){P.call(this);this.k="";this.j=!1}B(rFc,P);rFc.prototype.Z=g("k");rFc.prototype.Oa=function(a){this.k=a;this.j=!0;this.dispatchEvent("change")};function GFc(a,b){K.call(this);this.j=a;this.o=b;this.k=new R(this);L(this,this.k);this.k.F(a,"pivot-pill-created",this.q)}B(GFc,K);GFc.prototype.B=function(a){var b=a.j;-1==a.target.Z()?(b.j&&(M(b.j),b.j=null),b.dF()):0<HFc(this,b).length&&!b.j?(oFc(b),b.j.getElement().focus(),IFc(this,b,-2,!0)):b.dF()};
GFc.prototype.C=function(a){var b=a.j;a=a.target;var c=Om(b.j,a),d=b.Q();for(c++;c<b.j.Sb();){var e=b.j.dc(c),f=d.Ioa(e.getElement());nm(f,"waffle-pivot-select-divider")&&d.Af(f);b.j.removeChild(e,!0)}(0>a.Z()||!IFc(this,b,-2,!0))&&b.dF()};function JFc(a,b){a.k.F(b,"pivot-sort-by-change",a.B).F(b,"pivot-sort-key-change",a.C)}
GFc.prototype.q=function(a){var b=a.j;if(b instanceof J$){var c=0<HFc(this,b).length;a=this.j.getModel().fq();D(a,function(a,d){var h=a.getFunctionName(),l=E$(b,a.dg());b.o.Fd(new MD(c?h+(" of "+(l+" in...")):h+(" of "+l),d))});a=b.getModel();if(a.Rr()){var d=a.Jr();a=d.cR();KFc(this,b,a)&&(d=d.Er(),b.o.Oa(d),c&&(oFc(b),D(a,A(function(a){IFc(this,b,a,!1)},this)),IFc(this,b,-1,!1)))}JFc(this,b)}};
function IFc(a,b,c,d){var e=LFc(a,b);if(0==e.length)return!1;var f=b.j.Sb();a=HFc(a,b);if(f>=a.length)return!1;var h=E$(b,a[f].dg()),f=b.Q();a=b.j.Sb();var l=new RD,m=new MD(h,-2);m.ga(!1);l.Ia(m,!0);l.Ia(new MD(0==a?"Grand Total":"Total",-1),!0);for(m=0;m<e.length;m++)l.Ia(new MD(e[m],m),!0);h=new eG(h,l,G$.getInstance(),f);h.Oa(-2);b.j.Ia(h,!0);0<a&&(a=f.X("div",["goog-inline-block","waffle-pivot-select-divider"],":"),f.bu(a,h.getElement()));S(b).F(h,"action",b.vib);f=c;"string"==typeof c&&(f=jb(e,
c),-1==f&&(f=-2));h.Oa(f);d&&(b.j.gf(h),h.nd(!0));return!0}function LFc(a,b){var c=MFc(a,b),d=nFc(b),e=d.length,f=[];D(c,function(a){a.length==e+1&&pb(d,function(b,c){return a[c]==b})&&Ob(f,a[e])});return f}function KFc(a,b,c){a=MFc(a,b);return 0==c.length||ob(a,function(a){return Nb(c,a)})}function HFc(a,b){return b.isRow()?a.j.getModel().co():a.j.getModel().fo()}function MFc(a,b){return b.isRow()?AAa(a.j.getModel(),a.o):BAa(a.j.getModel(),a.o)};function Q$(a,b){dt.call(this,1601,b,of(Ju(a,b)));this.j=a}B(Q$,dt);Q$.prototype.exec=function(){var a=Ju(this.j,this.getModel()),b=this.getModel();TBa(b.o,a.y,"r")&&(a=this.getModel().Coa(),b=this.j,(a.Pa=b)||a.ba?wl(a,1024):a.j&=-1025)};Q$.prototype.Hc=function(){return Q$.H.Hc.call(this)};Q$.prototype.kd=q(48);Q$.prototype.dd=function(){var a=new Zr,b=TEc(this.j);J(a,2,b);var b=Ju(this.j,this.getModel()),c=new Oh;J(c,1,""+this.j.ym());c.zs(b.y);J(c,3,b.x);J(a,1,c);return a};function NFc(a,b,c,d,e){iW.call(this,a,c);this.j=a;this.k=b;this.G=d;this.B=e;this.J=new GFc(this.j,this.k);L(this,this.J);b=b.j;c=a.Q();this.O.F(a,"pivot-table-update",this.slb).F(a,"pivot-pill-added",this.klb).F(a,"pivot-pill-removed",this.mlb).F(a,"pivot-pill-changed",this.llb).F(a,"pivot-aggregation-orientation-changed",this.jlb).F(Gn,"show-pivot",this.rlb).F(e,"activeCellChange",this.Lea).F(e,"click",this.tlb,!0).F(e,"pivot_table_zippy_toggle",this.ulb).F(b,"a",this.Lea).F(b,"d",this.qlb).F(c.getElement("waffle-pivot-range-selection-button"),
"click",this.nlb).F(c.getElement("waffle-pivot-range-selection-button"),"keypress",this.olb);a=["Xa"];a.push("ha");this.O.F(Ou(b),a,this.Lea)}B(NFc,iW);t=NFc.prototype;t.X_=null;t.eB=null;t.Eg=function(){return V.o2};t.jq=function(){return V.n2};t.nlb=function(){OFc(this)};t.olb=function(a){13==a.keyCode&&(a.preventDefault(),a.stopPropagation(),OFc(this))};function OFc(a){CFc(a.j,A(a.plb,a,PFc(a)),ha)}
t.plb=function(a,b){a.C=b.mc;var c=XEc(b.Zf,b.rect);a.D=c;R$(this,a,this.j.B);var c=a.ym(),d=this.k.j;Cs(d)!=c&&ow(d,c)};t.rlb=function(){if(!iea(ye.getInstance())){var a=this.j;if(!a.Qa()){var b=this.k.j.getActiveGrid(),c=QFc(this);if(!c&&b){this.j.reset();var a=b.Mf,c=b.Hb(),d=Jv(c),e=Hv(c);d?(Ie?mq(a,e,Wb(zd)):oq(a,e,Wb(zd),this.O)).addCallback(A(this.yBa,this,b)):this.yBa(b,Av(c));return}this.eB=c;a.pe(c)}this.jq().fireAction()}};
t.llb=function(a){var b=a.container,c=a.q,d=a.j,e=a.j.getModel(),f=d;if(d&&c&&b!=c){f=RFc(d.getModel(),b);a:{var h=this.j;switch(b){case "row-breakout":case "col-breakout":var l="row-breakout"==b,f=new J$(f,O$(h),P$(h),l,h.Q());break a;case "aggregation":f=new K$(f,O$(h),P$(h),h.Q());break a;case "filter":f=new H$(f,O$(h),P$(h),h.Q());break a;default:f=null}}f.render();h=this.j;l=f;h.Q().wA(l.getElement(),d.getElement());var m=h.k[b],n=jb(m,d);yb(m,n,1,l);M(d);l.hc(h);AFc(h,l);sFc(h)}d=PFc(this);
a=a.position;h=c==b;l=f.getModel().dg();if(c)if(h){f=f.getModel();switch(b){case "row-breakout":SEc(d.o,f,a);break;case "col-breakout":SEc(d.k,f,a);break;case "filter":SEc(d.B,f,a);break;case "aggregation":UEc(d,f,a)}Jn(Gtc(a))}else SFc(this,b,d,l,a);else TFc(b,f,d);c&&!h&&UFc(e,c,d);R$(this,d,this.j.B)};
function RFc(a,b){switch(b){case "row-breakout":case "col-breakout":if(a instanceof Wf)return a;var c=new Wf,d=a.dg();J(c,9,d);return c;case "aggregation":if(a instanceof Yf)return a;c=new Yf;d=a.dg();J(c,3,d);return c;case "filter":if(a instanceof Rf)return a;c=new Rf;d=a.dg();J(c,6,d);return c;default:return null}}t.klb=function(a){var b=a.container,c=PFc(this);SFc(this,b,c,a.C,a.position);R$(this,c,this.j.B)};
t.mlb=function(a){var b=PFc(this);UFc(a.j.getModel(),a.container,b);M(a.j);R$(this,b,this.j.B)};t.jlb=function(){var a=PFc(this),b=this.j.Xo();a.G=b;R$(this,a,this.j.B)};
function SFc(a,b,c,d,e){switch(b){case "row-breakout":a=new Wf;J(a,9,d);d=a;null!=e?xb(c.o,d,e):c.o.push(d);break;case "col-breakout":a=new Wf;J(a,9,d);d=a;null!=e?xb(c.k,d,e):c.k.push(d);break;case "filter":a=Iu(a.k.j,c.nn()).Hb();a=kFc(d,c.xm(a),a);b=new Rf;J(b,6,d);VFc(b,a);null!=e?xb(c.B,b,e):c.B.push(b);break;case "aggregation":a=new Yf,J(a,3,d),YEc(a,"SUM"),WEc(c,a,e)}}
function UFc(a,b,c){switch(b){case "row-breakout":Vaa(c.o,a.equals,a);break;case "col-breakout":Vaa(c.k,a.equals,a);break;case "filter":Vaa(c.B,a.equals,a);break;case "aggregation":VEc(c,a)}}
function TFc(a,b,c){if("aggregation"==a)a=qb(c.fq(),function(a){return a.equals(b.getModel())}),null!=a&&YEc(a,b.Z());else if("filter"==a)a=qb(c.Kt(),function(a){return a.equals(b.getModel())}),null!=a&&VFc(a,fMb(I$(b),!0));else if(a=qb("row-breakout"==a?c.fo():c.co(),function(a){return a.equals(b.getModel())}),null!=a)if(bFc(a,b.k.Qc()),$Ec(a,b.C.Z()),-1!=b.o.Z()){var d=new Xf;d.Kn(b.o.Z());D(nFc(b),function(a){Lf(d,2,a)});ZEc(d,b.C.Z());J(a,10,d)}else a.kC()}t.slb=function(){R$(this,QFc(this),!0)};
function R$(a,b,c){b&&(c?(c=ws(a.k.j,b.ym()),c=new Q$(b,c),a.G.Ob(c),a.X_=null):a.X_=b,a.j.pe(b))}t.yBa=function(a,b){var c=a.Hb(),d=Jv(c),c=Hv(c);d&&b.equals(c)?CFc(this.j,A(this.xBa,this),A(this.vlb,this),!0):this.xBa(new ho(a.bb(),a.k,b))};t.vlb=function(){this.Eg().setVisible(!1);this.D.j(3)};
t.xBa=function(a){var b;b=new Zf;var c=new Sf,d=new Tf,e=new Uf,f=new Uf;J(e,1,1);J(f,1,1);d.KE(e);J(d,2,f);var e=new Tf,f=new Uf,h=new Uf;J(f,1,1);J(h,1,1);e.KE(f);J(e,2,h);J(c,1,d);J(c,2,e);J(b,6,c);J(b,5,2);b=EAa(b,0,new F(0,0),0);b.C=a.mc;a=XEc(a.Zf,a.rect);b.D=a;a=Cs(this.k.j);this.G.Ob(new B$(b,a))};function QFc(a){if(a.X_)return a.X_;(a=a.k.j.j)&&0==a.getSheetType()?(a=a.Hb(),a=RCa(a,Fv(a))):a=null;return a}function PFc(a){return(a=QFc(a))?a.clone():null}
t.Lea=function(a){var b=QFc(this);if(("Xa"==a.type||"ha"==a.type)&&!b&&this.eB&&(a=this.k.j.getActiveGrid())&&(a=a.Hb(),a.mb()==this.eB.ym())){var c=Ju(this.eB,a);c&&(Kv(a,c),b=QFc(this))}b&&!b.equals(this.eB,this.k)&&this.j.pe(b);this.eB=b;this.Eg().setVisible(!!b&&!GE(this.k))};t.qlb=function(a){a=a.target;if(this.eB&&this.eB.ym()==a.bb()&&this.j.Qa()){a=this.j;var b=bAa(a.Ua);b&&a.LR&&b.setVisible(!1)}};
t.tlb=function(a){var b=a.target;if(nm(b,Etc.oia)||nm(b,Etc.nia)){var b=zu(this.B).getModel(),c=wv(b,a.Ef);WFc(this,b,c);a.stopPropagation()}};t.ulb=function(a){var b=zu(this.B).getModel();a=wv(b,a.Ef);WFc(this,b,a)};
function WFc(a,b,c){if(!GE(a.k)){var d=c.nj();b=RCa(b,c);if(c=d.VN()){var e=c.length-1;c=c[e];for(var d="r"==d.dD()?b.fo()[e]:b.co()[e],e=Of(d,7),f,h=0;h<e.length;h++)if(e[h].Z()==c){f=e[h];var l=!H(f,3);J(f,3,l)}f||(f=new Vf,f.Oa(c),J(f,3,!0),Lf(d,7,f));Jn(H(f,3)?"Pivot table field collapsed":"Pivot table field expanded");R$(a,b,!0)}}}function VFc(a,b){Mf(a,3);J(a,5,!1);D(b,function(b){Lf(a,3,b)})}t.L=function(){NFc.H.L.call(this)};function XFc(){K.call(this)}B(XFc,vn);XFc.prototype.k=function(){return L$};XFc.prototype.j=function(){return NFc};Dn("pivottables",XFc);
