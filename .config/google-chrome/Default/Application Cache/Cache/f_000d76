function isc(a,b,c,d){var e=null;a.j.every(function(a,h,l){if(b&&(h>c||h==c&&l>=d))return!1;a.isEmpty()||(e=new F(l,h));return!0});return e}function jsc(a,b,c){var d=null;a.j.some(function(a,f,h){return(f>b||f==b&&h>c)&&!a.isEmpty()?(d=new F(h,f),!0):!1});return d}wL.prototype.Hoa=Z(277,function(a,b,c,d){for(var e=a-1,f=this.k.length;0<=e;){var h=this.k[e--];if(!(h.getSheetType()!=b||h.o&&d))return h}if(!c)return null;for(e=f-1;e>=a;)if(c=this.k[e--],!(c.getSheetType()!=b||c.o&&d))return c;return null});
function ksc(a,b,c){var d=0,e=-1;b&&(d=b.y,e=b.x);var f=null;return f=c?isc(a,!!b,d,e):jsc(a,d,e)}function lsc(a,b){if(!b)return null;var c=null;a.j.some(function(a,e,f){a=a.wc();for(var h=0;h<a.length;h++)if(a[h]==b)return c=new F(f,e),!0;return!1});return c}function msc(a){var b=new ed;a.j.forEach(function(a){a.isEmpty()||fd(b,a.wc())});return b.wc()}function nsc(a,b){var c=a.j.Od(b.y,b.x);return c?c.wc():[]}
function osc(a,b){var c=Cs(a.k);Rb(a.M,function(a,e){var f=this.C.eo(a);Number(e)==c&&b?om(f,"docs-icon-comment-blank-highlighted"):qm(f,"docs-icon-comment-blank-highlighted")},a)}function Q7(a){return a.j.hasUnpostedDocos()}function psc(a,b){for(var c=[],d=0;d<b.length;d++)c.push(a.k.j[b[d]]||0);a.j.deleteDocoPositions(c)}function qsc(a,b){var c={},d;for(d in b){var e=a.k.j[d]||0;e&&a.j.hasDoco(e)&&(c[e]=b[d])}return c}function rsc(a){return a.k}
function R7(a,b,c){co.call(this,10100,b);this.wb=a;this.j=b;this.k=c}B(R7,co);R7.prototype.Mi=Dc;R7.prototype.kd=q(35);R7.prototype.dd=function(){var a=new Rr,b=ko(this.k,this.j);J(a,1,this.wb);J(a,2,b);return a};R7.prototype.Ni=Dc;function ssc(a){this.j={};if(a)for(var b in a)this.set(b,a[b])}ssc.prototype.get=function(a){if(!(a in this.j))throw Error("No value for key "+a);return this.j[a]};ssc.prototype.set=function(a,b){this.j[a]=b};function tsc(a){this.j=new ssc;this.o=a||null}tsc.prototype.k=function(a){try{var b=Kd(a)}catch(c){return this.o&&this.o.log(Error("Invalid serialized anchor ID")),null}return this.j.get(b.type).j(b)};tsc.prototype.Wb=function(a){return Md(this.j.get(a.getType()).Wb(a))};function S7(a,b){this.o=a;this.k=b}S7.prototype.getType=g("o");function usc(a){S7.call(this,"range",0);this.q=a}B(usc,S7);usc.prototype.j=g("q");function vsc(){}ia(vsc);vsc.prototype.j=function(a){return new usc(a.range)};vsc.prototype.Wb=function(a){var b={};b.type=a.getType();b.uid=a.k;b.range=a.j();return b};function T7(a,b){S7.call(this,"workbook-range",0);this.B=a;this.q=!!b}B(T7,S7);T7.prototype.j=g("B");function wsc(){}ia(wsc);wsc.prototype.j=function(a){return new T7(a.range)};wsc.prototype.Wb=function(a){var b={};b.type=a.q?"range":"workbook-range";b.uid=a.k;b.range=a.j();return b};function U7(){tsc.call(this);var a=vsc.getInstance();this.j.set("range",a);a=wsc.getInstance();this.j.set("workbook-range",a)}B(U7,tsc);ia(U7);U7.prototype.k=function(a){return(a=U7.H.k.call(this,a))?("range"==a.getType()&&(a=new T7(a.j(),!0)),a):null};function V7(a,b){if(!b)return null;var c=b.j();return"range"==b.getType()?(c=a.j[c],xsc(c)?c.vb().wd():null):(c=ysc(b))&&zsc(Asc(c))?Asc(c).wd():null}function ysc(a){var b=new bo,c;try{c=ritz.getWorkbookRangeById(a.j(),!0)}catch(d){}return c?b.ld((new oi).U(),ritz.getWorkbookRangeById(a.j(),!0)):null}function Asc(a){return new lf(a.ob(),a.lb(),a.Kb(),a.Tb())}
function W7(a,b,c){return c?"range"==c.getType()?(b=b.j[c.j()],xsc(b)?(b=b.mb(),null!=b?Bsc(a,b):null):null):(b=ysc(c))&&zsc(Asc(b))?Bsc(a,parseInt(b.bb(),10)):null:null}function Bsc(a,b){var c=Iu(a,b);return c?c.Hb():null}function xsc(a){return!!a&&a.j&&zsc(a.vb())}function zsc(a){return!!a&&Aea(a)&&Ef(a)};function Csc(a,b,c,d,e,f,h,l,m,n,p){K.call(this);this.q=a;this.Ea=b;this.Y=c;this.Wa=d;this.D=e;this.Pa=f;this.j=h;this.ba=l;this.k=m;this.P=n;this.C=b.Ea;this.o=b.j;this.B=b.B;this.G=U7.getInstance();this.M={};this.K=new ed;this.V=new Ks(0);a=[this.V];Fb(p.k,a);z4a(p,a);p.j=x4a(p.k);y4a(p);this.J=new R(this);Dsc(this)}B(Csc,K);t=Csc.prototype;t.eea=!1;
function Dsc(a){var b=lb(Gya,function(a){return!Jya[a]});a.J.F(a.Wa,"activity-box-closed",a.c1a).F(a.D,"mouseover",X7(a,a.U7a)).F(a.D,"click",X7(a,a.S7a)).F(a.D,"selectionChange",X7(a,a.V7a)).F(a.D,"inputBoxActivate",X7(a,a.Q7a)).F(a.D,"hide_docos",X7(a,a.T7a)).F(a.o,"b",X7(a,a.bpb)).F(a.j,"view-comments",a.A5a).F(a.j,"comment-indicator-hover-start",a.y5a).F(a.j,"comment-indicator-hover-end",a.x5a).F(a.D,"insert_doco",a.Zob).F(new nu(a.ba),"mousewheel",a.$ob).F(a.B,["add_named_range","delete_named_range"],
a.L1a).F(a.Ea,"docos_change",a.b8a).F(a.P,"qe",a.cUa).F(a.o,"a",a.wsa);var c=Ou(a.o);a.J.F(c,b,a.R7a);a.J.F(c,["Fa"],X7(a,a.apb));KF(a.q,Docos.EventType.HOVER,X7(a,a.oXa));KF(a.q,Docos.EventType.SELECTED,X7(a,a.Yob));KF(a.q,Docos.EventType.CREATED,a.cra,a);KF(a.q,Docos.EventType.UNRESOLVED,a.cra,a);KF(a.q,Docos.EventType.DELETED,a.dra,a);KF(a.q,Docos.EventType.RESOLVED,a.dra,a);KF(a.q,Docos.EventType.POSTED,a.NXa,a);KF(a.q,Docos.EventType.PENDING,a.O2a,a);V.Rs.jc(Bq,A(a.v_a,a));T.Qu.jc(Bq,A(a.VTa,
a));T.uS.subscribe("action",A(a.x1a,a));T.vS.subscribe("action",A(a.G1a,a));T.wS.subscribe("action",A(a.H1a,a));a.wsa()}t.wsa=function(){var a=SG(this.o);T.uS.ga(a);T.vS.ga(a);T.wS.ga(a)};t.v_a=function(){this.q.setOption(Docos.OptionName.READONLY,!this.Ea.gr())};function X7(a,b){return A(function(a){this.eea||b.call(this,a)},a)}
t.Zob=function(){var a=pB(this.o),b=Gv(a);if(b&&!Q7(this.q)&&!Esc(this,a,b)){var c=ritz.getNewWorkbookRangeId();this.Pa.Ob(new R7(c,a.mb(),of(b)));a=this.G.Wb(new T7(c));if(a=Y7(this,a))this.k.dispatchEvent(new Z7("ye",[a],b)),this.Y.j(2)}};function Esc(a,b,c){c=nsc(lB(a.C,b),c);return c.length?(b=a.q,a=a.G.Wb(c[0]),b.j.highlightDoco(b.k.j[a]||0,!0),!0):!1}t.cra=function(a){D(a.j,function(a){$7(this,!0,a);this.K.add(a)},this)};t.dra=function(a){D(a.j,function(a){$7(this,!1,a);this.K.remove(a)},this)};
function $7(a,b,c,d,e){c=Y7(a,c);d=d||W7(a.o,a.B,c);e=e||V7(a.B,c);if(c&&d&&e){var f=lB(a.C,d);if(b){var h=f.j.Od(e.y,e.x)||new ed;h.add(c);Qu(f.j,e.y,e.x,h)}else(h=f.j.Od(e.y,e.x))&&h.remove(c);Qu(f.k,e.y,e.x,!0);f.q.zb()||f.q.start();a.o.getActiveGrid()&&(d=d==pB(a.o),b?(a=a.k,(b=d?e:null)&&af(b,a.QI)&&a.j.add(c),a.dispatchEvent(new Z7("re",[c],b))):(a=a.k,(b=d?e:null)&&af(b,a.QI)&&a.j.remove(c),a.xs==c&&(a.xs=null),a.dispatchEvent(new Z7("Ae",[c],b))))}else a.k.dispatchEvent("Ce")}
function Y7(a,b){if(!b)return null;if(!a.M[b]){var c=a.G.k(b);c&&(a.M[b]=c)}return a.M[b]}t.bpb=function(){this.k.reset()};t.oXa=function(a){a=Y7(this,a.j.length?a.j[0]:null);var b=V7(this.B,a);this.k.dispatchEvent(new Z7("ve",[a],b))};t.NXa=ba();t.O2a=function(){var a=this.V,b=this.q.j.hasPendingContent();Ls(a,Js(a.va,4,b))};t.c1a=function(){this.Y.j(3)};
t.Yob=function(a){if(!Q7(this.q)){var b=Y7(this,a.j.length?a.j[0]:null),c=V7(this.B,b);b&&c?(this.eea=!0,Fsc(this.k,b,c)):b||a.q?this.k.reset():b||this.Y.j(3)}};t.cUa=function(){this.eea=!1};t.T7a=function(){this.k.dispatchEvent("xe")};t.V7a=function(){if(!this.P.isEmpty()&&!Q7(this.q)){this.Y.j(3);var a=this.k,b=Gv(pB(this.o));af(a.hK,b)||!a.xs&&!a.al&&af(a.QI,b)||(a8(a),a.dispatchEvent(new Z7("ue",[],b)))}};
t.S7a=function(){var a=pB(this.o);if(!Q7(this.q)&&a){var b=lB(this.C,a),c=(a=Gv(a))?nsc(b,a):[];c.length&&(b=this.k,c=c[0],af(b.hK,a)?(a8(b),b.dispatchEvent(new Z7("se",[],a))):b.dispatchEvent(new Z7("se",[c],a)))}};t.Q7a=function(){Q7(this.q)||this.k.reset()};t.apb=function(){Gsc(this.k)};t.R7a=function(){Gsc(this.k)};
t.L1a=function(a){var b=a.Yd;if(b&&b.j)if(xsc(b)){var c;c=b.getId();c=this.G.Wb(new usc(c));a="add_named_range"==a.type;if(!a||this.K.contains(c)){var d=b.mb();b.Vd()&&null!=d&&(d=Bsc(this.o,d))&&$7(this,a,c,d,b.vb().wd())}}else this.k.dispatchEvent("Ce")};
t.b8a=function(a){a=a.docos||[];Hb(a);for(var b=0;b<a.length;b++){var c=this.G.Wb(new T7(a[b]));if(c){var d=Y7(this,c),e;a:{e=this.C;if(d){var f=void 0;for(f in e.j){var h=e.j[f],l=lsc(h,d);if(l){e={ab:h.Hb(),coord:l};break a}}}e=null}e?($7(this,!1,c,e.ab,e.coord),$7(this,!0,c),this.k.dispatchEvent("Ce")):this.K.contains(c)&&$7(this,!0,c)}}};
t.U7a=function(a){var b=pB(this.o);if(b){if((a=a.Ef)&&!tx(a)){var c=Hl(b,a.y,a.x);a=c?c.wd():a}else a=null;b=lB(this.C,b);b=a?nsc(b,a):[];c=this.k;c.j.clear();fd(c.j,b);c.QI=a;c.dispatchEvent(new Z7("te",b,a))}};t.A5a=function(){if(!Q7(this.q)){var a=this.k;if(a.al&&a.tP)a.tP=!1;else{var b=!a.al;a8(a);a.al=b;a.dispatchEvent("ze")}}};t.y5a=function(){if(!Q7(this.q)){var a=this.k;a.al||(a8(a),a.tP=!0,a.al=!0,a.dispatchEvent("ze"))}};t.x5a=function(){if(!Q7(this.q)){var a=this.k;a.al&&a.tP&&(a8(a),a.dispatchEvent("ze"))}};
t.$ob=function(a){a.stopPropagation()};t.HRa=function(a){var b=Y7(this,a);a=W7(this.o,this.B,b);if(!b||!a)return"";b=V7(this.B,b);a=wv(a,b).getDisplayValue();500<a.length&&(a=a.substring(0,499),a+="\u2026");return a};t.VTa=function(){var a;a=this.q;var b=a.j.getLinkedDoco();if(a=a.k.k[b]||null||"")(a=Y7(this,a))?(b=V7(this.B,a),Fsc(this.k,a,b)):T.Qu.fireAction()};t.x1a=function(){var a=pB(this.o);Esc(this,a,Gv(a))};t.G1a=function(){Hsc(this,!1)};t.H1a=function(){Hsc(this,!0)};
function Hsc(a,b){for(var c=Isc(a,b),d=mw(a.o),e=pB(a.o),f=Gv(e),h=lB(a.C,e),f=ksc(h,f,b),l=d;!f&&null!==l&&(l=c(l),e=l.Hb(),h=lB(a.C,e),f=ksc(h,null,b),l=l.ze,l!=d););f&&null!==l&&(c=nsc(h,f)[0],gt(a.o,l,A(a.cpb,a,e,c,f)))}function Isc(a,b){var c;c=b?A(a.o.Hoa,a.o):A(a.o.gW,a.o);return function(a){return c(a,0,!0,!0)}}t.cpb=function(a,b,c){Fsc(this.k,b,c);Kv(a,c)};
t.L=function(){delete this.D;delete this.ba;delete this.G;delete this.M;delete this.q;delete this.C;delete this.B;delete this.Pa;delete this.o;delete this.Ea;M(this.V);delete this.V;M(this.P);delete this.P;M(this.k);delete this.k;M(this.J);delete this.J;Csc.H.L.call(this)};function Z7(a,b,c){N.call(this,a);this.docos=b;this.o=b.length?b[0]:null;this.Y=c||null}B(Z7,N);function Jsc(){P.call(this);this.j=new ed}B(Jsc,P);t=Jsc.prototype;t.QI=null;t.hK=null;t.xs=null;t.al=!1;t.tP=!1;function Fsc(a,b,c){a8(a);a.xs=b;a.hK=c;a.dispatchEvent(new Z7("we",[b],c))}function Gsc(a){a.al||a.xs||a8(a);a.dispatchEvent("De")}t.reset=function(){a8(this);this.dispatchEvent("Be")};function a8(a){a.QI=null;a.j.clear();a.hK=null;a.xs=null;a.al=!1;a.tP=!1}t.L=function(){delete this.QI;delete this.j;delete this.hK;delete this.xs;Jsc.H.L.call(this)};function Ksc(a,b,c,d,e,f,h,l){vz.call(this,a,b,c,d,e,f,h,2,0,l)}B(Ksc,vz);Ksc.prototype.Va=function(a){return lIa(this,a,"range-border cell-border waffle-docos-target-cell-border")};function Lsc(a,b,c,d,e,f,h){P.call(this);this.q=a;this.ba=b;this.B=c;this.j=d;this.D=e;this.k=f;this.K=b.Ea;this.o=b.j;this.G=b.B;this.J=U7.getInstance();this.Ea=h||Lg();this.C=new ed;this.M=new ed;this.Y=new ed;this.P=new ed;this.V=new R(this);Msc(this);this.V.F(this.o,"a",this.gpb).F(this.k,"te",this.eVa).F(this.k,"ue",this.gVa).F(this.k,"se",this.dVa).F(this.k,"ve",this.pXa).F(this.k,"we",this.dpb).F(this.k,"De",this.fpb).F(this.k,"Be",this.epb).F(this.k,"ye",this.MXa).F(this.k,"Ce",this.t4a).F(this.k,
"re",this.nXa).F(this.k,"Ae",this.qXa).F(this.k,"xe",this.rXa).F(this.k,"ze",this.R2a);Nsc(this)}B(Lsc,P);t=Lsc.prototype;t.Dt=null;t.D6="none";t.Naa=500;t.jR=!1;t.rXa=function(){b8(this)};t.nXa=function(a){var b=a.o;b&&Osc(this,[b]);Psc(this,a.o)};t.qXa=function(a){var b=a.o;b&&Qsc(this,[b]);Psc(this,a.o)};function Psc(a,b){var c=W7(a.o,a.G,b);if(c){var d=lB(a.K,c);C3a(a.j,c.mb(),msc(d).length)}else Rsc(a)}t.R2a=function(){b8(this);this.k.al&&Ssc(this)};t.gVa=function(){b8(this)};
t.dVa=function(a){if(a.o){var b=a.o;this.jR=!0;a=this.q;b=this.J.Wb(b);a.j.highlightDoco(a.k.j[b]||0,void 0);this.jR=!1}else b8(this)};t.fpb=function(){var a=this.k.xs,b=this.C.isEmpty();this.k.al?Ssc(this):a?(Tsc(this,[a]),b&&!this.C.isEmpty()&&(this.jR=!0,b=this.q,a=this.J.Wb(a),b.j.highlightDoco(b.k.j[a]||0,void 0),this.jR=!1)):b||b8(this)};t.epb=function(){b8(this)};
function b8(a){a.C.clear();var b=a.q;b.j.flushDocoPositions(qsc(b,{}));b=a.q;b.j.highlightDoco(b.k.j[""]||0,void 0);Q(a.D,!1);M(a.Dt);Usc(a);Vsc(a);a.k.al||Wsc(a);osc(a.j,a.k.al);Nsc(a)}t.isEmpty=function(){return this.C.isEmpty()&&this.Y.isEmpty()&&this.M.isEmpty()&&this.P.isEmpty()};function Nsc(a){var b=zu(a.B);b&&(a.Naa=nGa(b.j)/2,a.q.setOption(Docos.OptionName.MAX_DOCO_HEIGHT,a.Naa))}function Vsc(a){og(a.Y.wc());a.Y.clear()}function Usc(a){og(a.M.wc());a.M.clear()}
function Wsc(a){D(a.P.wc(),function(a){qm(a,"waffle-docos-target-cell-header")});a.P.clear()}t.eVa=function(a){this.k.xs||this.k.al||(a=a.docos,a.length?Tsc(this,a):Xsc(this,!1))};function Tsc(a,b){Q7(a.q)||Qsc(a,hd(a.C,b).wc());Osc(a,b)}function Ssc(a){var b=pB(a.o);b&&(b=lB(a.K,b),Tsc(a,msc(b)),Ysc(a),Zsc(a))}t.dpb=function(a){$sc(this,a.o,a.Y)};
function $sc(a,b,c,d){var e=W7(a.o,a.G,b);if(e){var f=e.mb();if(atc(a,b)){var h=btc(a,c),l=function(){ctc(this,c)&&!h.equals(Hv(e))?(Nv(e,h),$sc(this,b,c,d)):(wv(e,c).Bj()&&aF(zu(this.B)).setVisible(!1),dtc(this,c),Tsc(this,[b]),Usc(this),Vsc(this),Wsc(this),etc(this,c),osc(this.j,this.k.al),d&&Ig(function(){this.q.j.grabFocus()},0,this),this.dispatchEvent("qe"))};Ie?jq(Eu(Iu(a.o,f)),A(e.Is,e,h)).addCallback(l,a):lq(Eu(Iu(a.o,f)),A(e.Is,e,h),A(l,a),new R)}else ow(a.o,f,A(function(){this.q.j.grabFocus();
$sc(this,b,c,!0)},a))}else a.dispatchEvent("qe")}function dtc(a,b){var c=pB(a.o),d=zu(a.B);if(!a.jR&&c&&d){var e=d.j,d=d.k,f=jy(e,"waffle",!1,!1),h=212;if(!e.xb()){var l=Rg("docs-docos-activitybox");l&&dl(l)&&(h+=f.right-bl(l).left)}l=ftc(a,b);h=l.x-f.right+h;f=l.y-f.bottom+a.Naa;if(!(0>=h&&0>=f)){d=d.j.wd();for(d=nf(d.y,d.x,d.y,d.x);vGa(e,d).height<f;)d.height+=1;for(;vGa(e,d).width<h;)d.width+=1;e=d.height;d=d.width;Ov(c,Oma(c,Lma(c,Ev(c),d,e)))}}}
function ctc(a,b){var c=pB(a.o);return ov(Al(c,"r"),b.y)&&ov(Al(c,"c"),b.x)}function btc(a,b){return Hl(pB(a.o),b.y,b.x)||of(b)}
t.pXa=function(a){if(!this.k.al&&(Usc(this),atc(this,a.o)&&(Xsc(this,!0),this.k.xs!=a.o))){var b=this.J.Wb(a.o),c=this.q;c.j.isDocoResolved(c.k.j[b]||0)?(b=a.Y,a=zu(this.B),(c=pB(this.o))&&a&&b&&(b=Hl(c,b.y,b.x)||of(b),b=uVa(a,b,"waffle-docos-target-cell-resolved-rect"),yx(BE(a),b,!0),b.setVisible(!0),this.M.add(b))):(c=a.Y,a=zu(this.B),(b=pB(this.o))&&a&&c&&(c=Hl(b,c.y,c.x)||of(c),b=new Ksc(b,a.J,a.K,a.C,a.j,a.k,new uy(c),this.Ea),yx(BE(a),b,!0),this.M.add(b),b.setVisible(!0)))}};
function gtc(a,b){b&&(om(b,"waffle-docos-target-cell-header"),a.P.add(b))}function etc(a,b){var c=zu(a.B),d=pB(a.o);d&&c&&b&&(d=Hl(d,b.y,b.x)||of(b),d=uVa(c,d,"waffle-docos-target-cell-rect"),yx(BE(c),d,!0),a.Y.add(d),d.setVisible(!0),d.getElement()&&a.V.F(d.getElement(),["click","contextmenu","dblclick","mousedown","mouseup"],function(a){a.Ef=b;c.dispatchEvent(a)}))}function Ysc(a){Vsc(a);var b={};D(a.C.wc(),function(a){a=V7(this.G,a);var d=a.x+"-"+a.y;b[d]||(etc(this,a),b[d]=!0)},a)}
function Zsc(a){Wsc(a);var b=pB(a.o),c=zu(a.B);if(b&&c){var d=c.C,c=c.k,b=lB(a.K,b),e=c.Kf("r"),f=c.ug("r"),h=c.Kf("c"),l=c.ug("c");D(msc(b),function(a){a=V7(this.G,a);a.x>=h&&a.x<=l&&gtc(this,WEa(d,a.x));a.y>=e&&a.y<=f&&gtc(this,d.j.getElement(ux(d,"rh-",Sv(d.o,a.y),null)))},a)}}t.t4a=function(){Rsc(this)};function Rsc(a){var b=mb(Xb(a.K.j),Number);D(b,function(a){var b=Bsc(this.o,a);b&&(b=lB(this.K,b),C3a(this.j,a,msc(b).length))},a)}
t.MXa=function(a){if(a.o){var b=this.J.Wb(a.o);a=ftc(this,a.Y);this.q.j.newDoco(b,a)}};
function Osc(a,b){for(var c={},d=[],e={},f=0;f<b.length;f++){var h=b[f],l=a.J.Wb(h),m;m=a;var n=h;if(zu(m.B)&&atc(m,n)){var p=V7(m.G,n);m=htc(m,btc(m,p))?m.k.al||m.k.xs==n||sb(m.k.j.wc(),n):!1}else m=!1;m?(m=V7(a.G,h),n=m=btc(a,m),n=n.ob()+"-"+n.Kb()+"-"+n.lb()+"-"+n.Tb()+"-"+n.j+"-"+n.Zc,e[n]=e[n]||0,c[l]=ftc(a,m.wd(),e[n]),e[n]++,a.C.add(h)):d.push(h)}a.C.isEmpty()||Xsc(a,!0);$b(c)||(e=a.q,e.j.updateDocoPositions(qsc(e,c)));Q7(a.q)||Qsc(a,d)}
function Qsc(a,b){var c=a.C.xq(b).wc();a.C.Fb(c);c=mb(c,function(a){return this.J.Wb(a)},a);c.length&&psc(a.q,c);a.C.isEmpty()&&Xsc(a,!1)}
function ftc(a,b,c){var d=zu(a.B),e=pB(a.o),f=d.j,h=f.xb(),l=btc(a,b),m=ky(f,l),n=c?15*c:0;c=h?m.left-n:m.right+n;var l=m.top+n,p=a.k.al;a=af(a.k.hK,b);var r=wv(e,b).Bj();p||a||!r?(b=l+125,0<b-nGa(f)&&(e=e.qn("r")-1,hy(f,b,"r","waffle")>=e&&(l-=50))):(a=aF(d),p=a.Tr,zWa(d,zv(e,b).wd()),e=a.D.height?a.Bb:0,b=a.G.height,d=Math.min(NHa.height,e+b),b&&(d=d+30+12,d+=oz.top,d+=oz.bottom),e&&(d+=12,d+=oz.top,d+=oz.bottom),e=d,qy(a,p),l+=e);m=h?m.right+n+212:m.left-n-212;n=h?0>c-212:c+212>Zx(f);e=h?m>Zx(f):
0>m;n&&!e&&(c=m);return new Docos.Point(h?cy(f,c,"c"):c,l)}function atc(a,b){var c=W7(a.o,a.G,b),d=pB(a.o);return!!c&&c==d}function htc(a,b){if(!b)return!1;var c=rsc(zu(a.B)),d=!1,e=b.wd();Eea(b,function(a,b){var l;if(l=a==e.y)l=null!=eE(c,new F(b,a));return l?d=!0:!1});return d}t.gpb=function(){Msc(this)};function Msc(a){var b=zu(a.B);b&&(a.Ea.appendChild(b.E1,a.D),a.q.setOption(Docos.OptionName.LAYOUT_RTL,b.j.xb()),a.q.setOption(Docos.OptionName.ANCHOR_DIV,a.D),a.q.j.renderAnchorSurface())}
function Xsc(a,b){var c,d=a.D.style;c="";"opacity"in d?c=d.opacity:"MozOpacity"in d?c=d.MozOpacity:"filter"in d&&(d=d.filter.match(/alpha\(opacity=([\d.]+)\)/))&&(c=String(d[1]/100));c=""==c?c:Number(c);c=sa(c)?1:c;dl(a.D)||(c=0);d=b&&1>c?"in":!b&&0<c?"out":"none";"none"==d?(M(a.Dt),Q(a.D,b)):a.Dt&&1==a.Dt.va&&a.D6==d||(M(a.Dt),Q(a.D,!0),a.Dt=new Mw(a.D,c,"in"==d?1:0,250),a.D6=d,"out"==d&&Ag(a.Dt,"finish",A(a.AYa,a)),a.Dt.play())}t.AYa=function(){b8(this);var a=zu(this.B);a&&FE(a)};
t.L=function(){delete this.B;delete this.D;delete this.J;delete this.q;delete this.C;delete this.k;delete this.K;delete this.Ea;delete this.D6;delete this.G;delete this.o;delete this.ba;M(this.Dt);delete this.Dt;Vsc(this);Usc(this);Wsc(this);M(this.V);delete this.V;Lsc.H.L.call(this)};function itc(a,b,c,d,e,f){K.call(this);this.G=a;this.K=w(b)?b:!0;this.J=w(c)?c:1;this.o=new Pp(A(this.BNa,this),d||1E3,e||6E4,f);L(this,this.o);this.B=new Yl(void 0,this);this.j=null;this.C=[];this.q="DCS_Callback"+String(jtc++);this.D=this.k=null}B(itc,K);var jtc=0;t=itc.prototype;t.P5=function(){this.j=null;this.o.stop();this.B.callback(this.C)};
t.Vla=function(a){a instanceof Zl||(a instanceof tn&&3==a.code?this.P5():(this.j=null,this.C.push(a instanceof Error?a.message:""),0<this.J--?this.o.start():this.B.errback(this.C)))};t.C$a=function(){this.o.zb()||this.o.start();var a=new Yl;cm(this.B,a);return a};
t.BNa=function(){if(this.K){this.k=new dx(this.G);this.k.Og=1E4;var a=A(this.P5,this);fa(this.q,a,void 0);this.D=this.k.send({callback:this.q},void 0,A(this.Vla,this))}else this.j&&this.j.cancel(),this.j=uMb(this.G,"dcs_main_js",{timeout:1E4}),$l(this.j,this.P5,this.Vla,this)};t.L=function(){this.j&&this.j.cancel();this.B.cancel();ea[this.q]&&(ea[this.q]=ha);this.k&&this.D&&this.k.cancel(this.D);itc.H.L.call(this)};function ktc(){return'<div class="docs-docos-activitybox" aria-label="Comment stream box."><div class="docs-docos-activitybox-inner"></div></div>'};function c8(a,b){Im.call(this,b);this.j=a}B(c8,Im);t=c8.prototype;t.O5=null;t.zM=null;t.jN=null;t.Mm=null;t.aja=!1;t.Ra=function(){c8.H.Ra.call(this);var a=this.Q(),b=Pt(ktc,{},{},a);this.aa=b;rh(b,!0);this.zM=a.getElement("docs-docos-caret");this.O5=Ah(a,"docs-docos-activitybox-inner",b);this.j&&(om(b,"docos-enable-new-header"),om(this.zM,"docos-enable-new-header"))};
t.Da=function(){this.jN=new aw(this.getElement());this.jN.Xi("close-box",27);this.Mm=new Pm(this.getElement(),"toggle_display");Qm(this.Mm,!0);var a=this.Mm;wna(a);a.j$=!1;this.Mm.Sma=!1;S(this).F(this.jN,"shortcut",this.M5a).F(this.Mm,"show",this.Wbb).F(this.Mm,"hide",this.Vbb).F(this.Mm,"beforeshow",this.Ubb).F(this.Mm,"beforehide",this.Tbb)};t.pb=g("O5");t.Wbb=function(){Q(this.zM,!0);this.dispatchEvent("show")};t.Vbb=function(){Q(this.zM,!1)};t.Ubb=function(){return this.dispatchEvent("beforeshow")};
t.Tbb=function(){return this.aja?!1:this.dispatchEvent("hide")};t.setVisible=function(a){this.Mm.setVisible(a)};t.Qa=function(){return!!this.Mm&&this.Mm.Qa()};t.M5a=function(a){switch(a.j){case "close-box":this.setVisible(!1)}};t.L=function(){M(this.jN);delete this.jN;delete this.zM;delete this.O5;M(this.Mm);delete this.Mm;c8.H.L.call(this)};function ltc(a,b,c,d){P.call(this);this.o=c||new Mg;this.j=a;this.C=!!b;this.k=new c8(this.j.isDocsStreamHeaderEnabled&&this.j.isDocsStreamHeaderEnabled(),this.o);this.O=new R(this);this.B=new vD(void 0,void 0,!0,fK.getInstance());this.q=d||T.iga;this.j.onReady(A(this.acb,this))}B(ltc,P);t=ltc.prototype;t.Cy=null;t.Tsa=!1;t.render=ba();
t.acb=function(){var a=this.o.getElement("docs-docos-commentsbutton");this.Cy=vW(null);Vy(this.Cy,16);this.Cy.Ta(a);Gd(Jd(),"docosUnreadCommentsEnabled")&&(this.j.setListener(Docos.EventType.UNREAD_COMMENTS,this.ucb,this),this.j.setOption(Docos.OptionName.ENABLE_UNREAD_COMMENTS,!0),T.Qu.jc(Dq,this.GJa,this));AD(this.B,this.Cy,T.Qu,BD);T.Qu.jc(Dq,this.ngb,this);this.k.render(a.parentNode.parentNode);Q(this.k.getElement(),!1);T.Qu.ga(!0);this.j.setOption(Docos.OptionName.PANE_DIV,this.k.pb());this.j.setOption(Docos.OptionName.PANE_KB_DIV,
this.k.getElement());this.j.renderPaneSurface();this.j.setListener(Docos.OptionName.DIALOG_OPENED,A(this.swa,this));this.j.setListener(Docos.OptionName.DIALOG_CLOSED,A(this.swa,this));this.j.setOption(Docos.OptionName.SORT_PANE,!0);this.j.setOption(Docos.OptionName.STREAM_BUTTON,a);Docos.EventType.CREATE_DRAFT&&(this.j.setListener(Docos.EventType.CREATE_DRAFT,this.dMa,this),this.q.jc(Bq,this.rwa,this),this.rwa(new tva("enabled",this.q.isEnabled(),!1)));this.C||this.j.setListener(Docos.EventType.NETWORK_ERROR,
this.Rbb,this);this.O.F(this.k,["show","hide"],this.Uab)};t.swa=function(a){this.k.aja=a.type==Docos.OptionName.DIALOG_OPENED};t.rwa=function(a){this.j.setOption(Docos.OptionName.ENABLE_COMMENT_BUTTON,a.newValue)};t.dMa=function(){this.k.setVisible(!1);this.q.fireAction()};t.ngb=function(){var a=this.k;a.Mm&&!xna(a.Mm)&&a.Mm.setVisible(!0)};
function mtc(a,b){if(0>b)throw Error("Number of unread comments cannot be negative");Qy(a.Cy,"docs-docos-commentsbutton-unread",0<b);var c=a.o.getElement("docs-docos-commentsbutton");a.o.Of(c,String(b))}t.ucb=function(){var a=this.j.getUnreadCommentsCount();mtc(this,a)};t.GJa=function(){mtc(this,0);this.j.ackUnreadComments()};
t.Rbb=function(){if(!this.Tsa&&T.Oi.isEnabled()){if(this.j.hasPendingContent()){var a=cp("Failed to post comment due to a network error.","warning",!0);ap.getInstance().postMessage(a)}this.j.setOption(Docos.OptionName.FATAL_READONLY,!0);this.j.setOption(Docos.OptionName.SHOW_ERRORS,!0);T.iga.ga(!1,"docos-fatal-reason");this.Tsa=!0}};t.Uab=function(a){a="show"==a.type;this.j.setOption(Docos.OptionName.SORT_PANE,!a);this.Cy.gc(a);a?this.j.grabFocus():this.dispatchEvent("activity-box-closed")};
t.L=function(){M(this.Cy);delete this.Cy;M(this.O);delete this.O;M(this.k);delete this.k;M(this.B);delete this.B;delete this.j;ltc.H.L.call(this)};function ntc(){K.call(this)}B(ntc,vn);t=ntc.prototype;t.IQa=function(){return itc};t.eRa=function(){return ltc};t.bRa=function(){return Csc};t.cRa=function(){return Jsc};t.dRa=function(){return Lsc};Dn("docos",ntc);
