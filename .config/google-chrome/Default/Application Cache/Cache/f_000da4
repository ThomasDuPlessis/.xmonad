pj.prototype.RN=Z(58,function(a){return H(this,2,a)});function IRb(a,b){var c=new CW,d;for(d in a.j)d in b.j||(c.j[d]=null);return c}function JRb(a){return""+MMb(Yt(a,{H5:"docs-icon-close-small"}))}
function KRb(a){return"<div"+(a.id?' id="'+W(a.id)+'"':"")+' class="'+(a.Re?W(a.Re)+" ":"")+'goog-flat-menu-button goog-flat-menu-button-disabled goog-inline-block" role="button" '+(a.Oo?'aria-label="'+W(a.Oo)+'"':"")+'><div class="goog-flat-menu-button-caption goog-inline-block">'+hu(a.ir)+'</div><div class="goog-flat-menu-button-dropdown goog-inline-block" aria-hidden="true">&nbsp;</div>'+(a.Ii?hu(a.Ii):"")+"</div>"}function LRb(){this.MV=this.Nm=null}
LRb.prototype.xa=function(){return new vD(this.Nm||void 0,void 0,!0,this.MV||fK.getInstance())};function MRb(a,b){iJ.call(this);this.va=a;this.j[a]=b}B(MRb,iJ);MRb.prototype.k=function(a){var b={};b[this.va]=a;jJ(this,b)};function pY(){NL.call(this);this.j=new CW;PL(this,new ML(OL,{},{wordList:[]}))}B(pY,NL);ia(pY);pY.prototype.k=function(a){NRb(this,a,!0)};function NRb(a,b,c){var d=a.j.contains(b.toLowerCase()),e=b.toLowerCase();a.j.add(e);if(!d){var f={};f.value=e;QL(a).get("wordList").push(f);c&&ORb(a,[b],[])}return!d}pY.prototype.q=function(a){PRb(this,a,!0)};
function PRb(a,b,c){var d=a.j.contains(b.toLowerCase());if(d){var e=b.toLowerCase();a.j.remove(e);for(var f=QL(a).get("wordList"),h=0;h<f.length;h++)if(f[h].value===e){f.splice(h,1);break}c&&ORb(a,[],[b])}return d}pY.prototype.o=function(a){a=a.get("wordList");for(var b=0;b<a.length;b++)NRb(this,a[b].value,!1);a.length&&this.dispatchEvent("userDictionaryChange")};
function ORb(a,b,c){var d={};d.dictSAdd=b;d.dictSRemove=c;a.dispatchEvent("userDictionaryChange");a.dispatchEvent(new SL(a,new RL("docs-user_dictionary",d),QL(a)))};function qY(a,b,c){Et.call(this,a,b,c);Tm(this,"Preferences")}B(qY,Et);t=qY.prototype;t.Da=function(){qY.H.Da.call(this);S(this).F(this,"dialogselect",this.hNa)};t.setVisible=function(a){qY.H.setVisible.call(this,a);a&&this.update()};t.update=ha;t.hNa=function(a){"ok"==a.key&&this.Iya()};t.Iya=ha;function QRb(a){return a=""+('<div class="docs-userdictionarydialog-content"><div class="docs-userdictionarydialog-top-container"><div><input class="docs-userdictionarydialog-input jfk-textinput" type="text" aria-label="'+W(a.Sta)+'" placeholder="'+W(a.Sta)+'"></div><div class="docs-userdictionarydialog-button-add-container">'+hz({Cd:"docs-userdictionarydialog-button-add",style:0,Ze:"Add"})+'</div></div><div class="docs-userdictionarydialog-list-container"></div></div>')};function RRb(a){return'<div class="docs-userdictionarydialog-row-container" role="option"><div title="'+W(a.UK)+'" class="docs-userdictionarydialog-row-content">'+W(a.UK)+"</div></div>"};function rY(a,b){Oy.call(this,void 0,new SRb);this.Nfa=a;this.j=b}B(rY,Oy);rY.prototype.mo=ba();rY.prototype.pI=function(a){a.relatedTarget&&mh(this.j,a.relatedTarget)||rY.H.pI.call(this,a)};rY.prototype.pj=function(a){return(46==a.keyCode||8==a.keyCode)&&this.Ji(a)};function SRb(){}B(SRb,Jy);SRb.prototype.Mb=q("docs-userdictionarydialog-row-container");SRb.prototype.Fg=function(a){return Pt(RRb,{UK:a.Nfa})};function sY(a){DD.call(this,void 0,new TRb);this.k=a;this.j=this.o=null}B(sY,DD);t=sY.prototype;t.Da=function(){sY.H.Da.call(this);lm(this.aa,"Personal dictionary entries.  Press DELETE or BACKSPACE to remove words from the dictionary.");gm(this.aa,"listbox");var a=this.o;Q(a,!1);fl(a,!0);this.j=new ku(a);S(this).F(this,"action",this.Uba).F(this.o,"click",this.Uba).F(this.j,"key",this.PUa)};t.$c=function(){sY.H.$c.call(this);M(this.j);this.j=null};
function URb(a){var b=[];a.Ff(function(a){b.push(a.Nfa)});return b}t.Uba=function(){var a;a=GD(this);var b=this.$o()==this.Sb()-1;ID(this);this.removeChild(a,!0);b||JD(this);VRb(this);this.dispatchEvent("change")};t.PUa=function(a){return 13==a.keyCode||32==a.keyCode?(this.Uba(),a.preventDefault(),a.stopPropagation(),!0):!1};t.wD=function(){0==Km(this,"docs-userdictionarydialog-row-container-hover").length&&HD(this)};t.kw=function(a){a.stopPropagation();a.preventDefault()};
t.gi=function(a){return 27==a.keyCode?!1:sY.H.gi.call(this,a)};t.kO=function(a){sY.H.kO.call(this,a);VRb(this)};t.j8=function(a){var b=wh(document);sY.H.j8.call(this,a);b&&nm(b,"docs-userdictionarydialog-list-remove-button")?this.aa.focus():VRb(this)};function VRb(a){if(GD(a)){var b;b=GD(a);var c=Math.round((al(b.aa).height-al(a.o).height)/2);a.o.style.top=Pk(b.aa).y+c+"px";lm(a.o,"Remove "+b.Nfa);Q(a.o,!0)}else Q(a.o,!1)}function TRb(){this.j=void 0}B(TRb,CD);
TRb.prototype.rp=function(a){var b=Pt(JRb,{enabled:!0,Re:"docs-userdictionarydialog-list-remove-button"});a.o=b;a.getElement().appendChild(b)};function tY(a,b,c,d){qY.call(this,b,c,d);this.G=a;this.o=new iz(null,d);this.Ia(this.o);this.cc=this.j=null;this.C=new sY(a);this.Ia(this.C);this.D=null;Tm(this,"Personal dictionary");a=dn((new Zm).set("ok","Save",!0),fn,!1,!0);bn(this,a)}B(tY,qY);t=tY.prototype;t.Ra=function(){tY.H.Ra.call(this);Nt(this.pb(),QRb,{Sta:"Add a new word"});JG(this,"ok");this.o.Ta(Lm(this,"docs-userdictionarydialog-button-add"));this.C.Ta(Lm(this,"docs-userdictionarydialog-list-container"));this.j=Lm(this,"docs-userdictionarydialog-input")};
t.Da=function(){tY.H.Da.call(this);this.o.ga(!1);this.cc=new Hy(this.j);S(this).F(this.o,"action",this.YTa).F(this.j,"keypress",this.ePa).F(this.cc,"input",this.dPa).F(this.C,"change",this.dXa);S(this).F(this.o.getElement(),"focus",this.i6).F(this.j,"focus",this.i6);for(var a=this.k.aa.getElementsByTagName("BUTTON"),b=0;b<a.length;b++)S(this).F(a[b],"focus",this.i6);this.D=new QI(this.C)};t.$c=function(){tY.H.$c.call(this);og(this.cc,this.D);this.D=this.cc=null};t.YTa=function(){WRb(this)};
t.dPa=function(){this.o.ga(!Ja($a(this.j.value)))};t.ePa=function(a){13==a.keyCode&&(this.o.isEnabled()&&WRb(this),a.stopPropagation(),a.preventDefault())};t.i6=function(){this.C.Wi(-1)};t.dXa=function(){cn(this.k,"ok").disabled=!1};t.update=function(){var a=this.C;a.sd(!0);var b=a.k.j.wc();b.sort(bNb());for(var c=0;c<b.length;c++)a.Ia(new rY(b[c],a.o),!0);XRb(this,"");cn(this.k,"ok").disabled=!0};
t.Iya=function(){var a,b;a=this.C;b=new CW(a.k.j.wc());var c=new CW(URb(a));a=IRb(c,b).wc();b=IRb(b,c).wc();for(var c=this.G,d=[],e=[],f=0;f<a.length;f++)NRb(c,a[f],!1)&&d.push(a[f]);for(f=0;f<b.length;f++)PRb(c,b[f],!1)&&e.push(b[f]);(0<d.length||0<e.length)&&ORb(c,d,e)};t.setVisible=function(a){tY.H.setVisible.call(this,a);if(a){var b=this.j;b&&(b.focus(),a=b.value.length,lEa(b)?(b.selectionStart=a,b.selectionEnd=a):od&&(a=nEa(b,a),b=b.createTextRange(),b.collapse(!0),b.move("character",a),b.select()))}};
function XRb(a,b,c){a.j.value=b;a.o.ga(!Ja($a(a.j.value)));c&&a.j.select()}function WRb(a){var b=a.C,c=a.j.value,c=c.toLowerCase().trim();-1==URb(b).indexOf(c)&&(c=new rY(c,b.o),b.jk(c,0,!0),b.aa.scrollTop=0,b.dispatchEvent("change"));PT(a.Q())==a.j&&a.j.blur();XRb(a,"");a.j.focus()};function YRb(a,b){var c=new tY(pY.getInstance());a.qi(c);return za(ZRb,c,b)}function ZRb(a,b,c){a.setVisible(!0);b().setVisible(!1);c&&XRb(a,c,!0)};function $Rb(){P.call(this);this.j=new ed}B($Rb,P);function aSb(a,b,c,d,e,f,h,l){this.j=a;this.D=b instanceof Element?Cc(b):b;this.G=c;this.J=d;this.k=e;this.o=f;this.q=h;this.B=l||null;this.O=new R(this);L(this,this.O)}B(aSb,K);t=aSb.prototype;t.cPa=function(a){var b=this.k.j;bSb(this.o,a);uY(this,b,!0)};
t.iVa=function(a){var b=this.k.j,c=this.o,d=Xa(a.Nt().getOriginalWord()),e=a.k;a=new br;J(a,1,"\\b"+d+"\\b");J(a,3,e);J(a,6,!1);J(a,7,!1);J(a,8,!0);a.Tc(2);J(a,11,0);var f,d=c.j.o;switch(c.j.K){case "RANGE":J(a,5,0);f=ko(d.rect,d.mc);J(a,9,f);f=Iu(c.k,d.mc);break;case "SHEET":J(a,5,1);f=new oi;J(f,1,""+d.mc);J(a,9,f);f=Iu(c.k,d.mc);break;case "WORKBOOK":J(a,5,2),f=c.k.gW(-1,0,!1)}f=f.Hb();c.o.Ob(new VW(f,0,a));uY(this,b,!0)};
t.SZa=function(a){var b=this.k.j;if(a){var c=this.J;c.j.contains(a.toLowerCase())||(c.j.add(a.toLowerCase()),c.dispatchEvent("ignoreWhitelistChange"))}uY(this,b,!1)};t.pWa=function(a){var b=this.k.j;if(a){var c=this.o.q,d=a.Nt().getOriginalWord();a=a.getSelection();if(!cSb(c,d,a)){var e=c.j[""+a.mc];e||(e=go(c.o,a.mc),e.getSheetType(),e=e.Hb(),e=new Pu(e,!0),c.j[""+a.mc]=e);c=a.Jb.y;a=a.Jb.x;var f=e.Od(c,a);f||(f=new ed,Qu(e,c,a,f));f.add(d.toLowerCase())}}uY(this,b,!1)};
t.B2a=function(a){var b=this.k.j;a&&(this.B?this.B.k(a):pY.getInstance().k(a));uY(this,b,!1)};t.Sqa=function(){T.K2.od(!1);this.O.kc(this.j,"close",this.Sqa);$ya(Ft.getInstance())||this.G.j(3);dSb(this.o.j);if(!T.Oi.isEnabled()){var a=ap.getInstance(),b=cp("Spellcheck will be unavailable until you reconnect.","info",!0,1E4);a.postMessage(b)}};
t.Wra=function(a){var b=this.j;Q(b.ba,!1);Q(b.Na,!0);var b=this.k,c=A(this.QCa,this,this.k.j,!1);this.q.wm().getSelection();b.j&&(a?b.C.unshift(b.j):b.M.push(b.j));eSb(b,c,!!a)};function uY(a,b,c){var d=a.j;Q(d.ba,!1);Q(d.Na,!0);b=A(a.QCa,a,b,c);a.q.wm().getSelection();eSb(a.k,b,!1)}
t.QCa=function(a,b){this.j.setVisible(!0);var c=this.j;Q(c.ba,!0);Q(c.Na,!1);var c=this.k.j,d=this.j,e=this.K,f=this.C;Jg(d.yb);var h=Ah(d.Q(),"docs-slidingdialog-content",d.getElement());h&&hm(h,"label",c?"Spellcheck":"No spelling suggestions");if(c){e=c.Nt();f=d.Q();S(d).kc(d.o,"focus",d.jsa).kc(d.o,"blur",d.isa).kc(d.G,"input",d.lsa).kc(d.o,"keydown",d.ksa);d.B.Oa("");var h=d.o,l=f.Hg(f.DRa(h));eh(l,h);d.o=f.getElement("docs-spellcheckslidingdialog-replacement-input");if(!d.o)throw Error("Replacement input not in DOM.");
M(d.removeChild(d.B));d.B=new nU("",f);d.Ia(d.B);d.B.Ta(d.o);M(d.G);d.G=new Hy(d.o);for(S(d).F(d.o,"focus",d.jsa).F(d.o,"blur",d.isa).F(d.G,"input",d.lsa).F(d.o,"keydown",d.ksa);0<d.k.Sb();)d.k.Eq(0).dispose();f="Next misspelling. Change "+(e.getOriginalWord()+" to:");hm(d.o,"label",f);d.Q().Of(d.He,e.getOriginalWord());f=e.j;if(0==f.length)d.B.Oa(e.getOriginalWord()),h=new MD("No suggestions"),d.k.Ia(h,!0),h.hf(2,!1),h.ga(!1),d.Sc.k(!1);else{d.B.Oa(f[0]);for(e=0;e<f.length;e++)h=new MD(f[e]),d.k.Ia(h,
!0),S(d).F(h,"action",d.q7a).F(h.getElement(),"dblclick",d.H0a),1<f.length&&(h.nq(!0),h=Rg("goog-menuitem-checkbox",h.aa),om(h,"goog-inline-block"));(e=d.k.dc(0))&&1<d.k.Sb()&&e.gc(!0);d.k.Wi(0);d.Sc.k(!0)}JMb(d.Va,c.getSelection());d.Zcb.call(d,0,-1);fSb(d.M);d.Ycb.call(d,-1);fSb(d.J);Q(d.jb,!1);Q(d.fb,!0)}else Q(d.fb,!1),ah(d.vc),e&&d.vc.appendChild(e),Q(d.jb,!0),e=w(f)?f:5E3,d.yb=Ig(A(d.qp,d),e),d.Va.Bv();this.j.focus();c?gSb(this.o,c.getSelection()):b&&gSb(this.o)};function hSb(a,b){this.k=a;this.j=b}hSb.prototype.Nt=g("j");function iSb(a,b,c){this.j=a;this.o=b;this.k=c||null}iSb.prototype.getOriginalWord=g("o");function vY(a,b,c,d,e){GW.call(this,e);this.D=a;this.C=b;this.Va=new FW(c);this.Ia(this.Va);this.P=new iz(null,e);this.Ia(this.P);this.J=new RD(e);this.vd=new LI(null,this.J,gN.getInstance());this.Ia(this.vd);this.Xa=new iz(null,e);this.Ia(this.Xa);this.M=new RD(e);this.Ed=new LI(null,this.M,gN.getInstance());this.Ia(this.Ed);this.Ib=this.V=this.K=null;this.B=new nU("",e);this.Ia(this.B);this.k=new jSb(e);SD(this.k,!1);this.Ia(this.k);this.yb=this.He=this.vc=this.jb=this.fb=this.G=this.o=null;this.Sc=
d;this.ba=this.Na=this.Ua=null}B(vY,GW);function fSb(a){pm(a.aa,["goog-menu-no-icon","goog-menu-noaccel"])}t=vY.prototype;
t.l6=function(){var a;a="";var b;b=""+('<div id="docs-spellcheckslidingdialog-loading"><div class="docs.spellcheckslidingdialog-loading-text">Loading spelling suggestions...</div><div class="docs-spellcheckslidingdialog-loading-spinner">'+BMb()+'</div></div><div id="docs-spellcheckslidingdialog-content"><div id="docs-spellcheckslidingdialog-no-misspellings" tabindex="-1"><div class="docs-spellcheckslidingdialog-title-text docs-spellcheckslidingdialog-no-misspellings">No spelling suggestions</div><div id="docs-spellcheckslidingdialog-no-misspellings-footer"></div></div><div id="docs-spellcheckslidingdialog-misspellings"><label class="docs-spellcheckslidingdialog-title-text goog-inline-block">Change <span id="docs-spellcheckslidingdialog-original-word"></span> to:</label><div class="docs-spellcheckslidingdialog-container"><table cellspacing="0" role="presentation"><tbody><tr><td class="docs-spellcheckslidingdialog-replacement-input-container"><input id="docs-spellcheckslidingdialog-replacement-input" autocomplete="off" type="text" class="docs-spellcheckslidingdialog-replacement-input" spellcheck="false"></input>'+KMb({id:"docs-spellcheckslidingdialog-replacement-context"})+
"</td><td>"+hz({id:"docs-spellcheckslidingdialog-button-change",style:2,Cd:"docs-spellcheckslidingdialog-buttons-action",Ze:"Change"})+KRb({id:"docs-spellcheckslidingdialog-button-change-menu",ir:""})+'</td></tr><tr><td><div id="docs-spellcheckslidingdialog-suggestion-list"></div></td><td id="docs-spellcheckslidingdialog-ignore-buttons">'+hz({id:"docs-spellcheckslidingdialog-button-ignore",style:0,Cd:"docs-spellcheckslidingdialog-buttons-action docs-spellcheckslidingdialog-buttons-white",Ze:"Ignore"})+
KRb({id:"docs-spellcheckslidingdialog-button-ignore-menu",Re:"docs-spellcheckslidingdialog-buttons-white-menu",ir:""})+"<br/>"+hz({id:"docs-spellcheckslidingdialog-button-dictionary",style:0,Cd:"docs-spellcheckslidingdialog-buttons-action docs-spellcheckslidingdialog-buttons-white",Ze:"Add to Dictionary"})+KRb({id:"docs-spellcheckslidingdialog-button-dictionary-menu",Re:"docs-spellcheckslidingdialog-buttons-white-menu",ir:""})+"</td></tr></tbody></table></div></div></div>");return a=a+NMb({sla:"Spellcheck",
Ze:""+b})};
t.Da=function(){vY.H.Da.call(this);om(this.aa,"docs-spellcheckslidingdialog");var a=this.Q();this.Na=a.getElement("docs-spellcheckslidingdialog-loading");this.ba=a.getElement("docs-spellcheckslidingdialog-content");this.jb=a.getElement("docs-spellcheckslidingdialog-no-misspellings");this.vc=a.getElement("docs-spellcheckslidingdialog-no-misspellings-footer");this.fb=a.getElement("docs-spellcheckslidingdialog-misspellings");this.o=a.getElement("docs-spellcheckslidingdialog-replacement-input");this.G=
new Hy(this.o);this.He=a.getElement("docs-spellcheckslidingdialog-original-word");this.Va.Ta(a.getElement("docs-spellcheckslidingdialog-replacement-context"));this.B.Ta(this.o);this.P.Ta(a.getElement("docs-spellcheckslidingdialog-button-change"));this.Xa.Ta(a.getElement("docs-spellcheckslidingdialog-button-ignore"));kSb(this.vd,this.P,"docs-spellcheckslidingdialog-button-change-menu",T.Oha,this.D,a);kSb(this.Ed,this.Xa,"docs-spellcheckslidingdialog-button-ignore-menu",T.Qha,this.D,a);this.k.Ta(a.getElement("docs-spellcheckslidingdialog-suggestion-list"));
KD(this.k,!0);fSb(this.k);AD(this.D,this.Xa,T.G1,BD,A(this.C.V,this.C));AD(this.D,this.P,T.oS,BD,A(this.RRa,this));this.K=new iz(null,this.Q());this.V=new RD(a);this.Ib=new LI(null,this.V,gN.getInstance(),a);this.Ia(this.K);this.Ia(this.Ib);this.K.Ta(a.getElement("docs-spellcheckslidingdialog-button-dictionary"));AD(this.D,this.K,T.l2,BD,A(this.UN,this,this.C));kSb(this.Ib,this.K,"docs-spellcheckslidingdialog-button-dictionary-menu",T.Pha,this.D,a);var a=new MD("View personal dictionary..."),b=ec(BD);
delete b["node-label"];delete b.label;AD(this.D,a,T.JB,b,A(this.UN,this,this.C));this.V.Ia(a,!0);fSb(this.V);S(this).F(this.k.getElement(),od?Afa:"focus",this.l6a);this.Ua=new NCb(this.getElement());L(this,this.Ua);a=sCb("Ctrl+single-quote",!1);b=sCb("Ctrl+semicolon",!1);zCb(this.Ua,T.L2,a);zCb(this.Ua,T.M2,b)};t.focus=function(){dl(this.fb)?this.B.gj():this.jb.focus()};
function kSb(a,b,c,d,e,f){c=f.getElement(c);a.Ta(c);mW(a,1);RBb(a,b.getElement());mW(b,2);if(b=new fx(c,a.Sd()?1:3))a.D=b,a.V=b.element;AD(e,a,d,BD)}t.Ycb=function(a){for(;0<this.J.Sb();)this.J.Eq(0).dispose();var b=Vg("span","docs-spellcheckslidingdialog-menu-text","Change all");a=Vg("span","docs-spellcheckslidingdialog-count",0>a?"":"("+(a+" found)"));var c=[];c.push(b);c.push(a);b=new MD(c);AD(this.D,b,T.M0,void 0,A(this.jMa,this));this.J.Ia(b,!0)};
t.Zcb=function(a,b){for(;0<this.M.Sb();)this.M.Eq(0).dispose();var c=Vg("span","docs-spellcheckslidingdialog-menu-text","Ignore all"),d=Vg("span","docs-spellcheckslidingdialog-count",0>b?"":"("+(b+" found)")),e=[];e.push(c);e.push(d);c=new MD(e);AD(this.D,c,T.H1,void 0,A(this.UN,this,this.C));this.M.Ia(c,!0)};function lSb(a){var b=a.B.Z();a=new iSb(b,a.UN(a.C),a.C);T.oS.fireAction(a)}t.H0a=function(){lSb(this)};t.jsa=function(){var a=this.Q().bw(this.o);om(a,"docs-spellcheckslidingdialog-replacement-input-container-focus")};
t.isa=function(){var a=this.Q().bw(this.o);qm(a,"docs-spellcheckslidingdialog-replacement-input-container-focus")};t.ksa=function(a){13==a.keyCode&&lSb(this)};t.l6a=function(){for(var a=0;a<this.k.Sb();a++){var b=this.k.dc(a);if(b.Qc()){b.gf(!0);return}}0<this.k.Sb()&&this.k.Wi(0)};function mSb(a){for(var b=0;b<a.k.Sb();b++)a.k.dc(b).gc(!1)}t.lsa=function(){mSb(this);this.Sc.k(!0)};t.q7a=function(a){var b=a.target.Z();mSb(this);this.B.Oa(b);(a=a.target)&&1<this.k.Sb()&&a.gc(!0);this.B.gj()};
t.RRa=function(){var a=this.B.Z();return new iSb(a,this.UN(this.C),this.C)};t.jMa=function(){var a=this.C,a=a.j?a.j.Nt():null;return new hSb(this.B.Z(),a)};t.UN=function(a){return(a=a.j)?a.Nt().getOriginalWord():null};t.L=function(){Jg(this.yb);M(this.G);vY.H.L.call(this)};function jSb(a,b){RD.call(this,a,b)}B(jSb,RD);jSb.prototype.gi=function(a){return 27==a.keyCode?!1:jSb.H.gi.call(this,a)};function nSb(a){var b="";a='<b>"'+(W(a.UK)+'"</b> added to your personal dictionary.');return Ut(b+('<span class="docs-userdictionary-butterbar-item">'+a+"</span>"))}function oSb(a){var b="";a='<b>"'+(W(a.UK)+'"</b> removed from your personal dictionary.');return Ut(b+('<span class="docs-userdictionary-butterbar-item">'+a+"</span>"))};function pSb(a,b){this.B=a;this.j=b;this.o=0}pSb.prototype.k=function(a){this.B.k(a);a=ep(Pt(nSb,{UK:a}),T.Mo.Ug(),A(this.q,this,a),"info",!0,1E4);bp(this.j,this.o);this.o=this.j.postMessage(a)};pSb.prototype.q=function(a){this.B.q(a);a=ep(Pt(oSb,{UK:a}),T.Mo.Ug(),A(this.k,this,a),"info",!0,1E4);bp(this.j,this.o);this.o=this.j.postMessage(a)};function qSb(a){K.call(this);this.o=a;this.j={};this.k=new R(this);L(this,this.k);this.k.F(a,"k",this.q)}B(qSb,K);function cSb(a,b,c){if(a=a.j[""+c.mc])if(c=a.Od(c.Jb.y,c.Jb.x))return!!c.contains(b.toLowerCase());return!1}qSb.prototype.q=function(a){M(this.j[""+a.Mg]);delete this.j[""+a.Mg]};function wY(){G.call(this)}var rSb;B(wY,G);wY.prototype.rangeCount=function(){return Kf(this,2)};function xY(){G.call(this)}var sSb;B(xY,G);xY.prototype.mb=function(){return H(this,1)};function yY(){G.call(this)}var tSb;B(yY,G);function zY(){G.call(this)}var uSb;B(zY,G);zY.prototype.RN=function(){return H(this,2)};function AY(){G.call(this)}var vSb;B(AY,G);AY.prototype.getOriginalWord=function(){return H(this,1)};
wY.prototype.U=function(){rSb||(rSb=Qf(wY,{0:{name:"SpellcheckRequest",hb:"ritzproto.SpellcheckRequest"},1:{name:"start_searching_column",R:5,type:Number},2:{name:"range",R:11,type:oi},3:{name:"search_all_sheets",R:8,type:Boolean},4:{name:"active_filter_views",Ec:!0,R:11,type:xY}}));return rSb};wY.ctor=wY;wY.ctor.U=wY.prototype.U;
xY.prototype.U=function(){sSb||(sSb=Qf(xY,{0:{name:"FilterViewDataProto",hb:"ritzproto.FilterViewDataProto"},1:{name:"grid_id",R:9,type:String},2:{name:"filter_view_id",R:9,type:String}}));return sSb};xY.ctor=xY;xY.ctor.U=xY.prototype.U;
yY.prototype.U=function(){tSb||(tSb=Qf(yY,{0:{name:"SpellcheckResponse",hb:"ritzproto.SpellcheckResponse"},1:{name:"last_row_searched",R:5,type:Number},2:{name:"last_column_searched",R:5,type:Number},3:{name:"last_grid_id_searched",R:9,type:String},4:{name:"searched_all_sheets",R:8,type:Boolean},6:{name:"searched_whole_range",R:8,type:Boolean},5:{name:"cell_suggestions",Ec:!0,R:11,type:zY}}));return tSb};yY.ctor=yY;yY.ctor.U=yY.prototype.U;
zY.prototype.U=function(){uSb||(uSb=Qf(zY,{0:{name:"CellSuggestionsProto",hb:"ritzproto.CellSuggestionsProto"},1:{name:"phrase_suggestions",Ec:!0,R:11,type:AY},2:{name:"cell",R:11,type:Oh}}));return uSb};zY.ctor=zY;zY.ctor.U=zY.prototype.U;
AY.prototype.U=function(){vSb||(vSb=Qf(AY,{0:{name:"PhraseSuggestionsProto",hb:"ritzproto.PhraseSuggestionsProto"},1:{name:"original_word",R:9,type:String},2:{name:"offset_start_index",R:5,type:Number},3:{name:"offset_end_index",R:5,type:Number},4:{name:"suggestions",Ec:!0,R:9,type:String}}));return vSb};AY.ctor=AY;AY.ctor.U=AY.prototype.U;function wSb(a,b){this.j=a;this.k=b}wSb.prototype.equals=function(a){return this.j.equals(a.Nt())&&this.k.equals(a.getSelection())};wSb.prototype.Nt=g("j");wSb.prototype.getSelection=g("k");function xSb(a,b){this.k=a;this.j=b}xSb.prototype.getOriginalWord=g("k");xSb.prototype.equals=function(a){var b=a.getOriginalWord();a=a.j;return this.k==b&&Nb(this.j,a)};function ySb(a,b,c){this.Jb=a;this.mc=b;this.Yd=c}ySb.prototype.equals=function(a){if(this===a)a=!0;else if(a instanceof ySb){var b;if(b=af(a.Jb,this.Jb)&&a.mc==this.mc)a=a.Yd,b=this.Yd,b=a==b?!0:a&&b?a.start==b.start&&a.end==b.end:!1;a=b}else a=!1;return a};function BY(a,b,c,d,e){this.q=a;this.Wa=b;this.Na=c;this.Pa=d;this.ba=e;this.k=this.B=this.j=null;this.D=!1;this.C=[];this.M=[];this.G=new R(this);L(this,this.G);this.J=null;this.K="RANGE";this.Y=new bo;this.Y.Gx=!0;this.P=new bo;this.P.Gx=!1}B(BY,K);BY.prototype.V=g("j");
function dSb(a,b,c){ww(a.J);a.G.Fb();a.K=b;a.o=c;a.D=!1;a.C=[];a.M=[];switch(b){case "WORKBOOK":a.B=new F(-1,0);(b=a.q.gW(-1,0,!1,!0))?a.k=""+b.bb():(a.k=null,a.D=!0);break;case "SHEET":a.B=new F(-1,0);a.k=""+c.mc;break;case "RANGE":a.B=new F(c.rect.left-1,c.rect.top),a.k=""+c.mc}}
function zSb(a,b){var c=b.getSelection(),d=Iu(a.q,c.mc),e;(e=!d)||(d=d.Hb(),e=c.Jb,e=!(ov(Al(d,"r"),e.y)&&ov(Al(d,"c"),e.x)));if(e)return!1;c=c.Yd;d=ASb(a,b);e=b.Nt().getOriginalWord();return d.substring(c.start,c.end)==e}function ASb(a,b){var c=BSb(a,b);return Ea(c,"'")?c.substring(1):c}function CSb(a,b){var c=BSb(a,b);return Ea(c,"'")}function BSb(a,b){var c=b.getSelection(),d=c.Jb,e=c.mc,f=Iu(a.q,e).Hb(),c=of(c.Jb);f.Is(c);return f.ad(d.y,d.x).getRawValue(e,d.y,d.x)}
function DSb(a,b){if(a.k){var c=new wY,d=new oi;J(d,1,a.k);J(d,2,a.B.y);switch(a.K){case "WORKBOOK":J(c,3,!0);si(d,0);for(var e=H3a(a.q),f=0;f<e.length;f++)if(0==e[f].getSheetType()){var h=e[f];ESb(c,h)}break;case "SHEET":si(d,0);h=Iu(a.q,a.o.mc);ESb(c,h);break;case "RANGE":si(d,a.o.rect.lb()),pi(d,a.o.rect.Kb()),ti(d,a.o.rect.Tb()),h=Iu(a.q,a.o.mc),ESb(c,h)}J(c,2,d);J(c,1,a.B.x+1);Oo(Ro(Po(No(a.Wa.ne("/spell"),{data:a.Y.Wb(c)})),function(a){this.Fh(a,b)},a),function(){this.Fh(null,b)},a).Bd()}else FSb(a,
b,!1)}function ESb(a,b){if(b){var c=Zv(b.Hb());if($u(c)){var d=""+b.bb(),c=c.getActiveFilterId(),e=new xY;J(e,1,d);J(e,2,c);Lf(a,4,e)}}}
BY.prototype.Fh=function(a,b){if(a){var c=this.P.ld(yY.U(),a.Se());this.B=new F(H(c,2),H(c,1));this.k=H(c,3);this.D=H(c,6);for(var c=Of(c,5),d=0;d<c.length;d++)for(var e=c[d],f=e.RN().Ot(),h=e.RN().Gf(),f=new F(h,f),h=parseInt(e.RN().bb(),10),e=Of(e,1),l=0;l<e.length;l++){var m=e[l],n=m.getOriginalWord(),p=H(m,2),r=H(m,3),p=new ySb(f,h,new cf(p,r));GSb(this,n,p)||(m=Of(m,4),this.C.push(new wSb(new xSb(n,m),p)))}}eSb(this,b,!1)};
function eSb(a,b,c){var d,e;c?(d=a.M,e=A(d.pop,d)):(d=a.C,e=A(d.shift,d));for(;0<d.length;){var f=e(),h=f.Nt().getOriginalWord();if(!GSb(a,h,f.getSelection())){e=c;h=f.getSelection();c=Iu(a.q,h.mc);d=c.Hb();h=of(h.Jb);f=A(a.Ea,a,f,b,e);d.Is(h)?f():Ie?(ww(a.J),a.J=iq(c.Mf,h).addCallback(f)):(a.G.Fb(),kq(c.Mf,h,f,a.G));return}}FSb(a,b,c)}function FSb(a,b,c){a.D||c?(a.j=null,b(null)):DSb(a,b)}BY.prototype.Ea=function(a,b,c){zSb(this,a)?(this.j=a,b(a.Nt())):eSb(this,b,c)};
function GSb(a,b,c){return a.Pa.j.contains(b.toLowerCase())||cSb(a.ba,b,c)||a.Na.j.contains(b.toLowerCase())}BY.prototype.L=function(){BY.H.L.call(this);ww(this.J)};function HSb(a,b,c,d){this.k=a;this.o=b;this.j=c;this.q=d}
function bSb(a,b){var c=b.k.j;if(zSb(a.j,c)){var d=c.getSelection(),e=d.mc,f=d.Yd,h=Iu(a.k,e).Hb(),l=CSb(a.j,c),c=ASb(a.j,c),f=(l?"'":"")+c.substring(0,f.start)+b.j+c.substring(f.end),m=new DF(h,of(d.Jb),f);fra(m,A(function(a){if(a){a=this.j;for(var c=b.j,e=0;e<a.C.length;e++){var f=a.C[e].getSelection();if(af(f.Jb,d.Jb)&&f.mc==d.mc&&f.Yd.start>d.Yd.end){var h=d.Yd,h=h.end-h.start-c.length;f.Yd.start-=h;f.Yd.end-=h}}}},a));e=new ho(e,"",of(d.Jb));hW(a.k,e,A(function(){this.o.Ob(m)},a))}}
function gSb(a,b){if(b){var c=new ho(b.mc,"",of(b.Jb));hW(a.k,c)}};function ISb(a){this.Bl=new IMb(a)}ISb.prototype.j=function(a){var b=new Dj,c=new oi;J(c,2,a.Jb.y);pi(c,a.Jb.y+1);si(c,a.Jb.x);ti(c,a.Jb.x+1);J(c,1,""+a.mc);Lf(b,2,c);c=new Oh;J(c,1,""+a.mc);c.zs(a.Jb.y);J(c,3,a.Jb.x);J(b,1,c);return this.Bl.j(new bP(b))};function JSb(a,b,c,d,e,f,h){EW.call(this,"docs-spellcheckslidingdialog-id",c,A(this.Uea,this));this.P=a;this.ba=new pSb(pY.getInstance(),ap.getInstance());this.M=new $Rb;this.K=new qSb(a);this.B=new BY(a,e,pY.getInstance(),this.M,this.K);this.Ea=new HSb(a,b,this.B,this.K);this.G=new vY((new LRb).xa(),this.B,new ISb(a),new MRb("trigger-text",!1));this.k=new aSb(this.G,A(this.SQa,this),c,this.M,this.B,this.Ea,d,this.ba);a=Lg();this.o=a.X("div",{style:"margin-top: 10px"});this.C=kz("Search the rest of the sheet",
a);this.C.render(this.o);this.q.F(this.C,"action",this.bfb);this.D=kz("Search all sheets",a);this.D.render(this.o);this.q.F(this.D,"action",A(this.Uea,this,"WORKBOOK"));TL(h,pY.getInstance(),"docs-user_dictionary");T.G1.subscribe("action",this.k.pWa,this.k);T.H1.subscribe("action",this.k.SZa,this.k);T.l2.subscribe("action",this.k.B2a,this.k);T.oS.subscribe("action",this.k.cPa,this.k);T.M0.subscribe("action",this.k.iVa,this.k);T.L2.subscribe("action",A(this.k.Wra,this.k,!1));T.M2.subscribe("action",
A(this.k.Wra,this.k,!0));T.JB.setVisible(!0);T.JB.subscribe("action",YRb(f,Cc(this.G)))}B(JSb,EW);t=JSb.prototype;t.eW=g("G");t.px=function(){JSb.H.px.call(this);this.q.F(this.j,"close",this.Anb).F(this.P,"sheet-view-obscured",this.Bnb)};t.Anb=function(){this.VC()};t.Bnb=function(){this.j.qp();this.VC()};
t.Uea=function(a,b){var c=a,d=b||null,e;if(!c){var f=this.P.j;f?0==f.getSheetType()?(d=Av(f.Hb()),1<Ff(d)?(c="RANGE",d=new ho(f.bb(),f.k,d)):(c="SHEET",d=new ho(f.bb(),f.k,null))):c="WORKBOOK":c="WORKBOOK"}"WORKBOOK"!=c&&(e=15E3);switch(c){case "RANGE":this.C.setVisible(!0);this.D.setVisible(!0);Q(this.o,!0);break;case "SHEET":this.C.setVisible(!1);this.D.setVisible(!0);Q(this.o,!0);break;case "WORKBOOK":Q(this.o,!1)}dSb(this.B,c,d);c=this.k;c.K=this.o;c.C=e;T.K2.od(!0);c.j.Yb()||c.j.render(c.D());
(e=c.j.GC)&&c.k.j?c.j.focus():(e||c.O.F(c.j,"close",c.Sqa),uY(c,null,!1))};t.SQa=function(){return Lg().getElement(this.bfa())};t.bfb=function(){var a=this.B.o;this.Uea("SHEET",new ho(a.mc,a.Zf,null))};function KSb(){K.call(this)}B(KSb,vn);KSb.prototype.j=function(a,b,c,d,e,f,h){return new JSb(a,b,c,d,e,f,h)};Dn("spellcheck",KSb);
